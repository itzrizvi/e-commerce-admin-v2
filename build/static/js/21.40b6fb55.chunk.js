(this.webpackJsonpprimeServerParts=this.webpackJsonpprimeServerParts||[]).push([[21],{621:function(e,n,a){"use strict";a.d(n,"a",(function(){return m}));var t,r,i,l,o,d,u,c=a(11),s=a(29),m={BANNER_ADD:Object(s.d)(t||(t=Object(c.a)(["\n    mutation addBanner($data: BannerInput) {\n        addBanner(data: $data) {\n        message\n        status\n        data {\n            banner_uuid\n        }\n      }\n    }"]))),BANNER_IMAGE_ADD:Object(s.d)(r||(r=Object(c.a)(["\n    mutation addBannerImage($data: BannerImageInput!) {\n      addBannerImage(data: $data) {\n        message\n        status\n        data {\n          banner_uuid\n          title\n          link\n          sort_order\n        }\n      }\n    }"]))),GET_ALL_BANNER:Object(s.d)(i||(i=Object(c.a)(["\n    query getAllBanners{\n      getAllBanners {\n        message\n        status\n        tenant_id\n        data {\n          banner_uuid\n          banner_name\n          banner_slug\n          banner_status\n          createdAt\n        }\n      }\n    }"]))),GET_SINGLE_BANNER:Object(s.d)(l||(l=Object(c.a)(["\n    query getSingleBanner($banner_uuid : UUID!){\n    getSingleBanner(query: {banner_uuid: $banner_uuid}) {\n      message\n      tenant_id\n      status\n      data {\n        banner_uuid\n        banner_name\n        banner_status\n        bannerimages {\n          banner_uuid \n          image\n          link\n          sort_order\n          title\n        }\n      }\n    }\n  }"]))),BANNER_UPDATE:Object(s.d)(o||(o=Object(c.a)(["\n  mutation updateBanner($data: UpdateBannerInput){\n    updateBanner(data:$data){\n      message\n      status\n    }\n  }"]))),BANNER_IMAGE_UPDATE:Object(s.d)(d||(d=Object(c.a)(["\n    mutation updateBannerImage($data: UpdateBannerImageInput){\n    updateBannerImage(data: $data) {\n      message\n      status\n    }\n  }"]))),BANNER_IMAGE_DELETE:Object(s.d)(u||(u=Object(c.a)(["\n    mutation deleteBannerImage($banner_uuid: UUID!) {\n      deleteBannerImage(data: {banner_uuid: $banner_uuid}) {\n        message\n        status\n        tenant_id\n      }\n    }"])))}},883:function(e,n,a){"use strict";a.r(n);a(130);var t=a(67),r=(a(131),a(43)),i=(a(281),a(132)),l=(a(256),a(147)),o=(a(197),a(121)),d=(a(358),a(701)),u=a(177),c=(a(607),a(606)),s=(a(143),a(68)),m=a(12),b=(a(280),a(59)),g=a(33),v=a(0),_=a.n(v),f=a(146),E=a(145),h=a(144),p=a(176),N=a(54),A=a(10),y=a(44),B=a(48),I=a(351),O=a(333),j=a(621),T=a(283),k=a(259),S=a(284),x=a(25),D=a.n(x),w=a(198),R=a.n(w),L=a(35);n.default=function(){var e,n;Object(L.b)("banner");var a=Object(N.useLocation)().search,x=R.a.parse(a),w=Object(N.useHistory)(),C=Object(y.d)((function(e){return e.auth.token})),U=Object(v.useState)(!1),z=Object(g.a)(U,2),G=z[0],$=z[1],P=Object(v.useState)(!0),F=Object(g.a)(P,2),M=F[0],q=F[1],V=Object(v.useState)(""),W=Object(g.a)(V,2),J=W[0],H=W[1],K=b.a.useForm(),Q=Object(g.a)(K,1)[0],Y=Object(v.useState)([]),X=Object(g.a)(Y,2),Z=X[0],ee=X[1],ne=Object(v.useState)({data:{},loading:!0,error:""}),ae=Object(g.a)(ne,2),te=ae[0],re=ae[1];Object(v.useEffect)((function(){T.b.query({query:j.a.GET_SINGLE_BANNER,variables:{banner_uuid:null===x||void 0===x?void 0:x.id},context:{headers:{TENANTID:"100001",Authorization:C}}}).then((function(e){var n,a,t,r,i=null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.getSingleBanner;if(i.status){re({data:null===i||void 0===i?void 0:i.data,loading:!1,error:""});var l=[];null===i||void 0===i||null===(a=i.data)||void 0===a||a.bannerimages.forEach((function(e){l.push({banner_id:e.banner_uuid,title:e.title,link:e.link,image:e.image,sort_order:e.sort_order})})),ee(l),q(null===i||void 0===i||null===(t=i.data)||void 0===t?void 0:t.banner_status),Q.setFieldsValue({banner_name:null===i||void 0===i||null===(r=i.data)||void 0===r?void 0:r.banner_name})}})).catch((function(e){console.log(e),re({data:{},loading:!1,error:"Something went worng"})}))}),[]);var ie=function(e){var n="image/jpeg"===e.type;n||B.b.error("You can only upload JPG file!");var a=e.size/1024/1024<1;return a||B.b.error("Image must smaller than 1MB!"),n&&a&&H(e),!1},le=_.a.createElement("div",null,_.a.createElement(I.a,null),_.a.createElement("div",{style:{marginTop:8}}," Upload ")),oe=function(e){if(e&&"target"in e&&"getAttribute"in e.target){var n=e.target.getAttribute("data-id");if(n)Z.map((function(e){return e.banner_id==n&&(e.image=J),e}))}},de=[{title:"Title",dataIndex:"title",key:"title",render:function(e,n){return _.a.createElement(s.a,{type:"text",defaultValue:n.title,placeholder:"Title",onChange:function(e){return n.title=e.target.value}})}},{title:"Link",dataIndex:"link",key:"link",render:function(e,n){return _.a.createElement(s.a,{type:"text",defaultValue:n.link,placeholder:"Link",onChange:function(e){return n.link=e.target.value}})}},{title:"Image",dataIndex:"image",key:"image",render:function(e,n){return _.a.createElement(c.a,{name:"avatar",listType:"picture-card","data-id":n.banner_id,className:"avatar-uploader",showUploadList:!1,beforeUpload:ie,onChange:oe(event),fileList:[]},n.image?_.a.createElement(S.LazyLoadImage,{src:"string"===typeof n.image?Object(k.renderImage)(null===x||void 0===x?void 0:x.id,n.image,"banner","128x128"):URL.createObjectURL(n.image),onError:k.errorImageSrc,alt:"image",style:{width:"100%"}}):le)}},{title:"Sort Order",dataIndex:"sort_order",key:"sort_order",width:150,render:function(e,n){return _.a.createElement(s.a,{type:"number",defaultValue:n.sort_order,placeholder:"Sort Order",onChange:function(e){return n.sort_order=parseInt(e.target.value)}})}},{title:"Action",dataIndex:"action",key:"action",render:function(e,n){return _.a.createElement(p.a,{size:"",title:"Remove",type:"danger"},_.a.createElement(D.a,{icon:"minus",onClick:function(){return ue(n.banner_id)}}))}}],ue=function(e){d.a.confirm({title:"Slider Remove Confirmation!",icon:_.a.createElement(O.a,null),content:"Do you want to permanently remove this slider?",okText:"Remove",cancelText:"Cancel",okType:"danger",onOk:function(){var n=Z.find((function(n){return n.banner_id===e}));(null===n||void 0===n?void 0:n.isNew)?(B.b.success("Slider Removed successfully"),ee((function(n){return n.filter((function(n){return n.banner_id!==e}))}))):T.a.mutate({mutation:j.a.BANNER_IMAGE_DELETE,variables:{banner_uuid:e},context:{headers:{TENANTID:"100001",Authorization:C}}}).then((function(n){var a,t;(null===n||void 0===n||null===(a=n.data)||void 0===a||null===(t=a.deleteBannerImage)||void 0===t?void 0:t.status)&&(B.b.success("Slider Removed successfully"),ee((function(n){return n.filter((function(n){return n.banner_id!==e}))})))})).catch((function(e){B.b.error("Something Went wrong!!")}))}})};return _.a.createElement(_.a.Fragment,null,_.a.createElement(f.a,{title:"Manage Banner | Edit Banner ".concat((null===te||void 0===te||null===(e=te.data)||void 0===e?void 0:e.banner_name)?"(".concat(null===te||void 0===te||null===(n=te.data)||void 0===n?void 0:n.banner_name,")"):"")}),_.a.createElement(E.b,null,_.a.createElement(t.a,{gutter:25},_.a.createElement(r.a,{sm:24,xs:24},_.a.createElement(h.a,{headless:!0},(null===te||void 0===te?void 0:te.loading)?_.a.createElement("div",{className:"spin"},_.a.createElement(o.a,null)):_.a.createElement(b.a,{style:{width:"100%"},form:Q,name:"addBanner",onFinish:function(e){var n=!0;if(Z.forEach((function(e){if(n&&(""==e.image||""==e.title))return B.b.info("Please Provide All Banner Image and Title!"),void(n=!1)})),n){var a;$(!0);var t=Object(m.a)(Object(m.a)({},e),{},{banner_status:M,banner_uuid:null===te||void 0===te||null===(a=te.data)||void 0===a?void 0:a.banner_uuid});T.b.mutate({mutation:j.a.BANNER_UPDATE,variables:{data:t},context:{headers:{TENANTID:"100001",Authorization:C}},refetchQueries:[{query:j.a.GET_ALL_BANNER,context:{headers:{TENANTID:"100001",Authorization:C}}},"getAllBanners"]}).then((function(e){Z.forEach((function(e){var n,a,t,r;(null===e||void 0===e?void 0:e.isNew)?T.a.mutate({mutation:j.a.BANNER_IMAGE_ADD,variables:{data:{banner_id:null===te||void 0===te||null===(n=te.data)||void 0===n?void 0:n.banner_uuid,title:e.title,sort_order:e.sort_order,link:e.link,image:e.image}},context:{headers:{TENANTID:"100001",Authorization:C}}}).then((function(e){})).catch((function(e){B.b.error("Something Went wrong!!")})):(r="string"==typeof e.image?{banner_id:null===te||void 0===te||null===(a=te.data)||void 0===a?void 0:a.banner_uuid,banner_uuid:e.banner_id,title:e.title,sort_order:e.sort_order,link:e.link}:{banner_id:null===te||void 0===te||null===(t=te.data)||void 0===t?void 0:t.banner_uuid,banner_uuid:e.banner_id,title:e.title,sort_order:e.sort_order,link:e.link,image:e.image},T.a.mutate({mutation:j.a.BANNER_IMAGE_UPDATE,variables:{data:r},context:{headers:{TENANTID:"100001",Authorization:C}}}).then((function(e){console.log(e)})).catch((function(e){B.b.error("Something Went wrong!!")})))}))})).catch((function(e){B.b.error("Something Went wrong !!!")})).finally((function(){$(!1),w.push("/admin/banner/list"),B.b.success("Banner Updated Successfully!"),setTimeout((function(){window.location.reload()}),1e3)}))}},onFinishFailed:function(e){return console.log("form error info:\n",e)},labelCol:{span:4}},_.a.createElement(b.a.Item,{rules:[{required:!0,max:50,message:"Please Enter Banner Name"}],name:"banner_name",label:"Banner Name"},_.a.createElement(s.a,{placeholder:"Enter Banner Name"})),_.a.createElement(b.a.Item,{label:"Status"},_.a.createElement(l.a,{checked:M,onChange:function(e){return q(e)},checkedChildren:"ON",unCheckedChildren:"OFF"})),_.a.createElement(i.a,{className:"table-responsive",columns:de,pagination:!1,rowKey:"banner_id",size:"small",dataSource:Z}),_.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"10px",marginBottom:"10px"}},_.a.createElement(p.a,{size:"small",title:"Add Banner",htmlType:"button",type:"primary"},_.a.createElement(D.a,{icon:"plus",onClick:function(){var e={banner_id:(new Date).getTime(),title:"",link:"",image:"",sort_order:"",isNew:!0};ee((function(n){return[].concat(Object(u.a)(n),[e])}))}}))),_.a.createElement("div",{style:{display:"flex",justifyContent:"flex-start"}},_.a.createElement(b.a.Item,null,_.a.createElement(p.a,{loading:G,size:"default",htmlType:"submit",type:"primary",raised:!0},G?"Processing":"Save"),_.a.createElement(A.b,{to:"/admin/banner/list"},_.a.createElement(p.a,{style:{marginLeft:10},type:"light",size:"default"},"Cancel"))))))))))}}}]);