(this.webpackJsonpprime_server_parts=this.webpackJsonpprime_server_parts||[]).push([[82],{944:function(e,t,a){"use strict";a.r(t);a(150);var n=a(77),r=(a(166),a(98)),l=(a(314),a(218)),i=(a(200),a(97)),c=(a(201),a(74)),o=(a(288),a(69)),s=(a(290),a(117)),u=a(9),m=a(92),d=(a(289),a(52)),E=a(23),f=(a(148),a(45)),b=a(0),p=a.n(b),h=a(217),O=a(165),j=a(164),v=a(287),g=a(58),y=a(12),_=a(71),I=a(50),R=a(22),S=a(76),A=f.a.TextArea;t.default=function(){Object(R.f)("role");var e=Object(g.useHistory)(),t=Object(I.d)((function(e){return e.auth.token})),a=Object(b.useState)([]),T=Object(E.a)(a,2),x=T[0],N=T[1],C=Object(b.useState)(!1),P=Object(E.a)(C,2),D=P[0],L=P[1],w=Object(b.useState)(!0),k=Object(E.a)(w,2),z=k[0],F=k[1],q=Object(b.useState)({data:[],isLoading:!0,error:""}),M=Object(E.a)(q,2),W=M[0],H=M[1],J=d.a.useForm(),G=Object(E.a)(J,1)[0],K=[{title:"Permission Name",dataIndex:"roles_permission_name"},{title:"Access",dataIndex:"id",render:function(e,t,a){return p.a.createElement(s.a,{onChange:function(e){var t=e.target.checked;N((function(e){var n=Object(m.a)(e),r=Object(u.a)(Object(u.a)({},n[a]),{},{read_access:t});return n[a]=r,n}))}})}},{title:"Modify",dataIndex:"Modify",render:function(e,t,a){return p.a.createElement(s.a,{onChange:function(e){var t=e.target.checked;N((function(e){var n=Object(m.a)(e),r=Object(u.a)(Object(u.a)({},n[a]),{},{edit_access:t});return n[a]=r,n}))}})}}];Object(b.useEffect)((function(){_.j.query({query:_.e.GET_ALL_ROLES_PERMISSION,context:{headers:{TENANTID:100001,Authorization:t}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getAllRolesPermission;if(!(null===a||void 0===a?void 0:a.isAuth))return H((function(e){return Object(u.a)(Object(u.a)({},e),{},{error:"You Are not Authorized"})}));H((function(e){return Object(u.a)(Object(u.a)({},e),{},{data:null===a||void 0===a?void 0:a.data,error:""})})),N((function(e){return null===a||void 0===a?void 0:a.data.map((function(e){return{permission_id:e.id,read_access:!1,edit_access:!1}}))}))})).finally((function(){H((function(e){return Object(u.a)(Object(u.a)({},e),{},{isLoading:!1})}))}))}),[]);return p.a.createElement(p.a.Fragment,null,p.a.createElement(h.a,{title:"Add Role"}),p.a.createElement(O.b,null,p.a.createElement(i.a,{gutter:25},p.a.createElement(c.a,{sm:24,xs:24},p.a.createElement(j.a,{headless:!0},p.a.createElement(d.a,{style:{width:"100%"},form:G,name:"addRole",onFinish:function(a){L(!0);var n=Object(u.a)(Object(u.a)({},a),{},{role_status:z,permissionsData:x});_.j.mutate({mutation:_.d.CREATE_ROLE_WITH_PERMISSION,variables:{data:n},context:{headers:{TENANTID:100001,Authorization:t}}}).then((function(t){var n,r=null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.createRoleWithPermission;if(!(null===r||void 0===r?void 0:r.status))return Object(S.a)();setTimeout((function(){e.push("/admin/roles/list")}),1e3),o.b.success("".concat(a.role," role created successfully."))})).finally((function(){return L(!1)}))},onFinishFailed:function(e){return console.log("form error info:\n",e)},labelCol:{span:4}},p.a.createElement(i.a,{gutter:25},p.a.createElement(c.a,{span:10},p.a.createElement(d.a.Item,{rules:[{required:!0,max:30,message:"Please enter Role Name"}],name:"role",label:"Name",labelCol:{style:{width:"40%"}}},p.a.createElement(i.a,null,p.a.createElement(c.a,{span:22},p.a.createElement(f.a,{placeholder:"Enter Role Name"})))))),p.a.createElement(i.a,{gutter:25},p.a.createElement(c.a,{span:18},p.a.createElement(d.a.Item,{rules:[{required:!0,message:"Please enter Role Description"}],name:"roleDescription",label:"Description",labelCol:{style:{width:"21.5%"}}},p.a.createElement(i.a,null,p.a.createElement(c.a,{span:18},p.a.createElement(A,{rows:4,placeholder:"Enter Role Description"})))))),p.a.createElement(d.a.Item,{name:"role_status",label:"Status"},p.a.createElement(l.a,{checked:z,onChange:function(e){return F(e)}})),p.a.createElement(i.a,{gutter:25},p.a.createElement(c.a,{span:24},p.a.createElement("h2",{style:{fontSize:"15px",fontWeight:"600"}},"Select Permissions For This Role:"),p.a.createElement(d.a.Item,{name:"permissionsData"},W.isLoading?p.a.createElement("div",{className:"spin"},p.a.createElement(r.a,null)):W.error?p.a.createElement("p",null,W.error):p.a.createElement(n.a,{pagination:!1,columns:K,rowKey:"id",dataSource:W.data})))),p.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"3em"}},p.a.createElement(d.a.Item,null,p.a.createElement(v.a,{loading:D,size:"default",htmlType:"submit",type:"primary",raised:!0},D?"Processing":"Save"),p.a.createElement(y.b,{to:"/admin/roles/list"},p.a.createElement(v.a,{style:{marginLeft:10},type:"light",size:"default"},"Cancel"))))))))))}}}]);