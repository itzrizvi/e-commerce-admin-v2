(this.webpackJsonpprime_server_parts=this.webpackJsonpprime_server_parts||[]).push([[63],{1023:function(e,a,t){"use strict";t.r(a);t(200);var r=t(96),n=(t(201),t(74)),l=(t(317),t(79)),c=(t(319),t(229)),i=(t(312),t(219)),o=(t(288),t(118)),s=(t(289),t(88)),u=(t(166),t(97)),m=(t(287),t(53)),d=t(23),g=(t(377),t(221)),E=(t(202),t(64)),y=(t(148),t(45)),p=t(0),f=t.n(p),_=t(21),b=t.n(_),v=t(218),h=t(165),T=t(164),O=t(59),j=t(12),I=t(217),C=t(71),A=t(56),D=t(315),N=t.n(D),S=t(51),w=t(69),M=t.n(w),x=t(22),P=t(115),k=y.a.TextArea,q=E.a.Option,G=g.a.Dragger;a.default=function(){Object(x.f)("category");var e=m.a.useForm(),a=Object(d.a)(e,1)[0],t=Object(p.useState)(!0),g=Object(d.a)(t,2),_=g[0],D=g[1],w=Object(p.useState)(!1),L=Object(d.a)(w,2),R=L[0],F=L[1],V=Object(p.useState)(!1),z=Object(d.a)(V,2),K=z[0],U=z[1],Y=Object(O.useLocation)().search,B=N.a.parse(Y),J=Object(O.useHistory)(),Q=Object(p.useState)([]),H=Object(d.a)(Q,2),W=H[0],X=H[1],Z=Object(p.useState)({data:[],loading:!0}),$=Object(d.a)(Z,2),ee=$[0],ae=$[1],te=Object(p.useState)({}),re=Object(d.a)(te,2),ne=re[0],le=re[1],ce=Object(p.useState)(""),ie=Object(d.a)(ce,2),oe=ie[0],se=ie[1],ue=Object(p.useState)(null),me=Object(d.a)(ue,2),de=me[0],ge=me[1],Ee=Object(p.useState)(""),ye=Object(d.a)(Ee,2),pe=ye[0],fe=ye[1];Object(p.useEffect)((function(){C.j.query({query:C.l.GET_ALL_CATEGORIES,context:{headers:{TENANTID:"100001"}}}).then((function(e){var a,t=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.getAllCategories;if(!t.status)return Object(P.a)();X(t.categories)})).catch((function(e){}))}),[]),Object(p.useEffect)((function(){if(W.length){var e=[];W.forEach((function(a){var t=a.cat_name,r=a.cat_sort_order;e.push({cat_name:t,id:a.id,cat_sort_order:r}),a.subcategories&&a.subcategories.forEach((function(a){var r=a.cat_name;e.push({cat_name:"".concat(t," > ").concat(r),id:a.id})}))})),ae({data:e,loading:!1})}}),[W]),Object(p.useEffect)((function(){B.id&&C.j.query({query:C.l.GET_SINGLE_CATEGORY_FOR_UPDATE,variables:{query:{cat_id:parseInt(B.id)}},context:{headers:{TENANTID:"100001"}}}).then((function(e){var a,t=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.getSingleCategory;if(!t.status)return Object(P.a)();le(t.category),F((function(e){var a;return(null===t||void 0===t||null===(a=t.category)||void 0===a?void 0:a.is_featured)||e})),D((function(e){var a;return(null===t||void 0===t||null===(a=t.category)||void 0===a?void 0:a.cat_status)||e})),se((function(e){var a;return(null===t||void 0===t||null===(a=t.category)||void 0===a?void 0:a.cat_parent_id)||e}))})).catch((function(e){S.b.error("Something went worng.!")}))}),[]);return f.a.createElement(f.a.Fragment,null,f.a.createElement(v.a,{title:B.id?"Manage category | Edit - ".concat(ne.cat_name?"(".concat(ne.cat_name,")"):"","\t"):"Add Category"}),f.a.createElement(h.b,null,f.a.createElement(r.a,{gutter:25},f.a.createElement(n.a,{sm:24,xs:24},f.a.createElement(T.a,{headless:!0},B.id&&!ne.id?f.a.createElement("div",{className:"spin"},f.a.createElement(u.a,null)):f.a.createElement(m.a,{style:{width:"100%"},form:a,name:"addRole",onFinish:function(e){U(!0);var a=e.categoryName,t=e.categoryDescription,r=e.categoryMetaTagDescription,n=e.categoryMetaTagKeywords,l=e.categoryMetaTagTitle,c=e.categorySortOrder;if(B.id){var i={cat_id:parseInt(B.id),cat_name:a,cat_description:t,cat_meta_tag_title:l,cat_meta_tag_description:r,cat_meta_tag_keywords:n,is_featured:R,cat_status:_};oe&&(i.cat_parent_id=oe),de&&(i.categoryImage=de.file),c&&(i.cat_sort_order=parseInt(c)),C.a.mutate({mutation:C.k.UPDATE_CATEGORY,variables:{data:i},refetchQueries:[{query:C.l.GET_ALL_CATEGORIES,context:{headers:{TENANTID:"100001"}}},["getAllBrands"]],fetchPolicy:"network-only",context:{headers:{TENANTID:"100001",Authorization:M.a.get("psp_t")}}}).then((function(e){var a,t=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.updateCategory;if(!(null===t||void 0===t?void 0:t.status))return S.b.error(null===t||void 0===t?void 0:t.message);setTimeout((function(){J.push("/admin/categories/list")}),1e3),S.b.success(null===t||void 0===t?void 0:t.message)})).catch((function(e){})).finally((function(){U(!1)}))}else{var o={categoryName:a,categoryDescription:t,categoryMetaTagDescription:r,categoryMetaTagKeywords:n,categoryMetaTagTitle:l,isFeatured:R,categoryStatus:_};oe&&(o.categoryParentId=oe),c&&(o.categorySortOrder=parseInt(c));var s={data:o};de&&(s.file=de),console.log(s),C.a.mutate({mutation:C.k.CREATE_CATEGORY,variables:s,refetchQueries:[{query:C.l.GET_ALL_CATEGORIES,context:{headers:{TENANTID:"100001"}}},["getAllCategories"]],fetchPolicy:"network-only",context:{headers:{TENANTID:"100001",Authorization:M.a.get("psp_t")}}}).then((function(e){var a,t=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.createCategory;if(!(null===t||void 0===t?void 0:t.status))return S.b.error(null===t||void 0===t?void 0:t.message);setTimeout((function(){J.push("/admin/categories/list")}),1e3),S.b.success(null===t||void 0===t?void 0:t.message)})).catch((function(e){})).finally((function(){U(!1)}))}},onFinishFailed:function(e){return console.log("form error info:\n",e)},labelCol:{span:4}},f.a.createElement(s.a,null,f.a.createElement(s.a.TabPane,{tab:"General",key:"general"},f.a.createElement(m.a.Item,{rules:[{required:!0,max:30,message:"Please enter Category Name"}],name:"categoryName",label:"Category Name",initialValue:ne.cat_name||""},f.a.createElement(y.a,{placeholder:"Enter Category Name"})),f.a.createElement(m.a.Item,{rules:[{required:!0,max:30,message:"Please enter Category Description"}],name:"categoryDescription",label:"Description",initialValue:ne.cat_description||""},f.a.createElement(k,{rows:4,placeholder:"Enter Category Description"})),f.a.createElement(m.a.Item,{rules:[{required:!0,max:30,message:"Please enter Meta Title"}],name:"categoryMetaTagTitle",label:"Meta Tag Title",initialValue:ne.cat_meta_tag_title||""},f.a.createElement(y.a,{placeholder:"Enter Meta Tag Title"})),f.a.createElement(m.a.Item,{name:"categoryMetaTagDescription",label:"Meta Tag Description",rules:[{required:!0,max:30,message:"Please enter Meta Description"}],initialValue:ne.cat_meta_tag_description||""},f.a.createElement(k,{rows:3,placeholder:"Enter Meta Tag Description"})),f.a.createElement(m.a.Item,{className:"wrap-label",rules:[{required:!0,max:30,message:"Please enter Meta Keywords"}],name:"categoryMetaTagKeywords",label:"Enter Meta Tag Keywords",initialValue:ne.cat_meta_tag_keywords||""},f.a.createElement(k,{rows:3,placeholder:"Enter Meta Tag Keywords"}))),f.a.createElement(s.a.TabPane,{tab:"Data",key:"Data"},f.a.createElement(m.a.Item,{name:"categoryParentId",initialValue:"",label:"Parent"},ee.loading?f.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},f.a.createElement(u.a,null)):f.a.createElement(f.a.Fragment,null,f.a.createElement(E.a,{allowClear:!0,placeholder:"Please select",onChange:function(e){return se(e)},defaultValue:ne.cat_parent_id},ee.data.map((function(e){return f.a.createElement(q,{key:e.id,value:e.id},e.cat_name)}))))),f.a.createElement(m.a.Item,{name:"categorySortOrder",label:"Sort Order",initialValue:ne.cat_sort_order||""},f.a.createElement(y.a,{placeholder:"Enter Sort Order"})),f.a.createElement(m.a.Item,{name:"isFeatured",label:"Is Featured"},f.a.createElement(o.a,{checked:R,onChange:function(e){return F(e.target.checked)}})),f.a.createElement(m.a.Item,{name:"categoryStatus",label:"Status"},f.a.createElement(i.a,{checked:_,onChange:function(e){return D(e)}})),f.a.createElement(m.a.Item,{name:"img",label:"Image"},pe?f.a.createElement(l.a,{text:"x"},f.a.createElement(c.a,{shape:"square",size:80,src:pe,onClick:function(){ge(null),fe("")}})):f.a.createElement(G,{multiple:!1,beforeUpload:function(e){return"image/jpeg"===e.type?e.size/1024/1024<2?(fe(URL.createObjectURL(e)),ge(e),!1):S.b.error("Image must smaller than 2MB!"):S.b.error("You can only upload JPG file!")},onRemove:function(e){fe(""),ge(null)},fileList:de?[de]:[],style:{marginTop:"3em"}},f.a.createElement("p",{className:"ant-upload-drag-icon"},f.a.createElement(b.a,{icon:"upload",size:50})),f.a.createElement(A.a,{as:"h4",className:"ant-upload-text"},"Drag and drop an image"),f.a.createElement("p",{className:"ant-upload-hint"},"or ",f.a.createElement("span",null,"Browse")," to choose a file"))))),";",f.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"3em"}},f.a.createElement(m.a.Item,null,f.a.createElement(I.a,{loading:K,size:"default",htmlType:"submit",type:"primary",raised:!0},K?"Processing":"Save"),f.a.createElement(j.b,{to:"/admin/categories/list"},f.a.createElement(I.a,{style:{marginLeft:10},type:"light",size:"default"},"Cancel"))))))))))}}}]);