(this.webpackJsonpprime_server_parts=this.webpackJsonpprime_server_parts||[]).push([[68],{972:function(e,t,a){"use strict";a.r(t);a(133);var n,r=a(71),i=(a(145),a(30)),o=(a(143),a(68)),l=(a(144),a(52)),c=(a(115),a(39)),u=(a(132),a(74)),d=(a(303),a(217)),s=a(7),m=a(8),p=a(14),f=(a(629),a(632)),b=a(0),g=a.n(b),_=a(19),v=a.n(_),h=a(120),E=a(101),O=a(99),j=a(100),y=a(195),A=a(12),C=a(23),P=a(28),S=a(103),I=a.n(S),L=a(72),T=a.n(L),x=a(122),k=a(157),w=a(219),D=a(17),N=a(33),z=f.a.RangePicker;t.default=function(){Object(C.c)("product");var e=Object(b.useState)({data:[],isLoading:!1}),t=Object(p.a)(e,2),a=t[0],f=t[1],_=Object(b.useState)([]),S=Object(p.a)(_,2),L=S[0],U=S[1],q=Object(b.useState)([]),F=Object(p.a)(q,2),R=F[0],G=F[1],B=Object(b.useState)(""),W=Object(p.a)(B,2),J=W[0],K=W[1],M=Object(b.useState)(!1),V=Object(p.a)(M,2),Y=V[0],H=V[1],Q=Object(b.useState)(!0),X=Object(p.a)(Q,2),Z=X[0],$=X[1],ee=Object(b.useState)({data:[],isLoading:!0}),te=Object(p.a)(ee,2),ae=te[0],ne=te[1],re=Object(b.useState)({data:[],isLoading:!0}),ie=Object(p.a)(re,2),oe=ie[0],le=ie[1],ce=Object(b.useState)({data:[],isLoading:!0}),ue=Object(p.a)(ce,2),de=ue[0],se=ue[1],me=Object(b.useState)({data:[],isLoading:!0}),pe=Object(p.a)(me,2),fe=pe[0],be=pe[1],ge=Object(b.useState)({availability:[],categories:[],condition:[],attributes:[],startDate:"",endDate:"",minPrice:"",maxPrice:""}),_e=Object(p.a)(ge,2),ve=_e[0],he=_e[1];Object(b.useEffect)((function(){P.j.query({query:P.l.GET_ALL_CATEGORIES,context:{headers:{TENANTID:"100001"}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getAllCategories;if(a.status&&a.categories.length){var n=[];a.categories.forEach((function(e){var t=e.cat_name;n.push({cat_name:t,id:e.id}),e.subcategories&&e.subcategories.forEach((function(e){var a=e.cat_name;n.push({cat_name:"".concat(t," > ").concat(a),id:e.id}),e.subsubcategories&&e.subsubcategories.forEach((function(e){var r=e.cat_name;n.push({cat_name:"".concat(t," > ").concat(a," > ").concat(r),id:e.id})}))}))})),ne({data:n,isLoading:!1})}})).catch((function(e){})),P.j.query({query:Object(D.d)(n||(n=Object(m.a)(["\n          query getAllAttributes {\n            getAllAttributes {\n              message\n              status\n              tenant_id\n              data {\n                id\n                attribute_name\n              }\n            }\n          }\n        "]))),context:{headers:{TENANTID:"100001",Authorization:T.a.get("psp_t")}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getAllAttributes;a.status&&le({data:a.data,isLoading:!1})})),P.j.query({query:P.m.GET_ALL_AVAILABILITY,context:{headers:{TENANTID:"100001",Authorization:T.a.get("psp_t")}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getAllProductAvailabilityStatus;a.status&&se({data:a.data,isLoading:!1})})),P.j.query({query:P.m.GET_ALL_CONDITIONS,context:{headers:{TENANTID:"100001",Authorization:T.a.get("psp_t")}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getAllProductCondition;a.status&&be({data:a.data,isLoading:!1})}))}),[]);var Ee=[{title:"ID",dataIndex:"id",key:"id",width:70,ellipsis:!0,sorter:function(e,t){return e.id.toUpperCase()>t.id.toUpperCase()?1:-1}},{title:"Logo",dataIndex:"id",key:"id",width:70,render:function(e,t){return g.a.createElement(w.LazyLoadImage,{effect:"blur",width:"40",src:Object(k.renderImage)(t.id,t.prod_thumbnail,"product/image/thumbnail","128x128"),onError:k.errorImageSrc,alt:t.id})}},{title:"Product Name",dataIndex:"prod_name",key:"prod_name",ellipsis:!0,sorter:function(e,t){return e.prod_name.toUpperCase()>t.prod_name.toUpperCase()?1:-1}},{title:"Product SKU",dataIndex:"prod_sku",key:"prod_sku",ellipsis:!0,sorter:function(e,t){return e.prod_sku.toUpperCase()>t.prod_sku.toUpperCase()?1:-1}},{title:"Part NO",dataIndex:"prod_partnum",key:"prod_partnum",ellipsis:!0,sorter:function(e,t){return e.prod_partnum.toUpperCase()>t.prod_partnum.toUpperCase()?1:-1}},{title:"Regular Price",dataIndex:"prod_regular_price",key:"prod_regular_price",ellipsis:!0,align:"center",sorter:function(e,t){return e.prod_regular_price>t.prod_regular_price?1:-1}},{title:"Sales Price",dataIndex:"prod_sale_price",key:"prod_sale_price",ellipsis:!0,align:"center",sorter:function(e,t){return e.prod_sale_price>t.prod_sale_price?1:-1}},{title:"Status",dataIndex:"prod_status",key:"prod_status",width:80,align:"middle",sorter:function(e,t){return e.prod_status===t.prod_status?0:e.prod_status?-1:1},filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:function(e,t){return t.prod_status===e},render:function(e,t){return g.a.createElement(d.a,{defaultChecked:e,title:"Status",onChange:function(e){return function(e,t){P.j.mutate({mutation:P.k.UPDATE_PRODUCT,variables:{data:{prod_id:e.id,prod_status:t}},context:{headers:{TENANTID:"100001",Authorization:T.a.get("psp_t")}}}).then((function(t){var a,n=null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.updateProduct;if(!n.status)return N.b.error(n.message);N.b.success("".concat(e.prod_sku," status updated."))})).catch((function(e){return N.b.error("Something Went wrong !!")}))}(t,e)}})}},{title:"On Sale",dataIndex:"is_sale",key:"is_sale",align:"center",width:90,sorter:function(e,t){return e.is_sale===t.is_sale?0:e.is_sale?-1:1},filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:function(e,t){return t.is_sale===e},render:function(e,t){return g.a.createElement(d.a,{defaultChecked:e,title:"Is Sale",onChange:function(e){return function(e,t){P.j.mutate({mutation:P.k.UPDATE_PRODUCT,variables:{data:{prod_id:e.id,is_sale:t}},context:{headers:{TENANTID:"100001",Authorization:T.a.get("psp_t")}}}).then((function(t){var a,n=null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.updateProduct;if(!n.status)return N.b.error(n.message);N.b.success("".concat(e.prod_sku," status updated."))})).catch((function(e){return N.b.error("Something Went wrong !!")}))}(t,e)}})}},{title:"Action",dataIndex:"action",width:140,align:"center",render:function(e,t){return g.a.createElement(g.a.Fragment,null,g.a.createElement(A.b,{to:"/admin/products/view?id=".concat(t.id)},g.a.createElement(I.a,{name:"eye",style:{margin:".5em 1em",color:"rgb(46, 204, 113)"}})),g.a.createElement(A.b,{to:"/admin/products/edit?id=".concat(t.id)},g.a.createElement(I.a,{name:"edit",style:{margin:".5em 1em",color:"#5F63F2"}})))},key:"last_name"}];return Object(b.useEffect)((function(){if(!a.isLoading){var e=L;if(J&&(e=e.filter((function(e){return((null===e||void 0===e?void 0:e.prod_name)+(null===e||void 0===e?void 0:e.prod_sku)).toLowerCase().includes(J.toLowerCase())}))),ve.startDate){var t=new Date(ve.startDate).valueOf(),n=new Date(ve.endDate).valueOf();e=e.filter((function(e){var a=parseInt(e.createdAt);return a>=t&&a<=n}))}ve.attributes.length&&(e=e.filter((function(e){return ve.attributes.find((function(t){return e.prod_attributes.map((function(e){return e.attribute_data.id})).includes(t)}))}))),ve.categories.length&&(e=e.filter((function(e){return ve.categories.includes(e.category.id)}))),ve.availability.length&&(e=e.filter((function(e){return ve.availability.includes(e.prod_outofstock_status)}))),ve.condition.length&&(e=e.filter((function(e){return ve.condition.includes(e.prod_condition)}))),ve.minPrice&&(e=e.filter((function(e){return e.prod_regular_price>=parseFloat(ve.minPrice)}))),ve.maxPrice&&(e=e.filter((function(e){return e.prod_regular_price<=parseFloat(ve.maxPrice)}))),G(e)}}),[Y]),g.a.createElement(g.a.Fragment,null,g.a.createElement(h.a,{title:"Products",buttons:[g.a.createElement("div",{key:"1",className:"page-header-actions"},g.a.createElement(j.a,{size:"small",type:"white",onClick:function(){return $((function(e){return!e}))}},g.a.createElement(v.a,{icon:"filter"}),"Filter"),g.a.createElement(A.b,{to:"/admin/products/add"},g.a.createElement(j.a,{size:"small",title:"Add Product",type:"primary"},g.a.createElement(v.a,{icon:"file-plus"}))))]}),g.a.createElement(E.b,null,g.a.createElement(o.a,{gutter:25},g.a.createElement(l.a,{sm:24,xs:24},g.a.createElement(O.a,{headless:!0},a.isLoading?g.a.createElement("div",{className:"spin"},g.a.createElement(u.a,null)):g.a.createElement(g.a.Fragment,null,g.a.createElement(o.a,{gutter:25},g.a.createElement(l.a,{span:18},g.a.createElement(c.a,{placeholder:"Search Products...",prefix:g.a.createElement(y.a,null),onChange:function(e){var t=e.target.value;K(t)}})),g.a.createElement(l.a,{span:6},g.a.createElement(j.a,{size:"large",type:"primary",onClick:function(){f((function(e){return Object(s.a)(Object(s.a)({},e),{},{isLoading:!0})})),P.j.query({query:P.l.GET_PRODUCT_LIST,context:{headers:{TENANTID:"100001",Authorization:T.a.get("psp_t")}},fetchPolicy:"cache-first"}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getProductList;(null===a||void 0===a?void 0:a.status)&&U(null===a||void 0===a?void 0:a.data)})).catch((function(e){f((function(e){return Object(s.a)(Object(s.a)({},e),{},{error:"Something went Wrong.!! "})}))})).finally((function(){f((function(e){return Object(s.a)(Object(s.a)({},e),{},{isLoading:!1})})),H(!Y)}))}},"Search"))),g.a.createElement("br",null),g.a.createElement("br",null),Z&&g.a.createElement("div",{style:{marginBottom:"2.5em"}},g.a.createElement(o.a,{gutter:16},g.a.createElement(l.a,{span:8},"Availability: ",g.a.createElement("br",null),g.a.createElement(i.a,{style:{width:"100%"},placeholder:"Select status",size:"middle",mode:"multiple",onChange:function(e){he((function(t){return Object(s.a)(Object(s.a)({},t),{},{availability:e})}))},options:de.data.map((function(e){return{label:e.name,value:e.name}}))})),g.a.createElement(l.a,{span:8},"Category: ",g.a.createElement("br",null),g.a.createElement(i.a,{style:{width:"100%"},placeholder:ae.isLoading?"Loading..":"Select category",size:"middle",mode:"multiple",optionFilterProp:"label",onChange:function(e){he((function(t){return Object(s.a)(Object(s.a)({},t),{},{categories:e})}))},options:ae.data.map((function(e){return{label:e.cat_name,value:e.id}}))})),g.a.createElement(l.a,{span:8},"Date: ",g.a.createElement("br",null),g.a.createElement(z,{style:{height:"40px",width:"100%"},size:"small",onChange:function(e){he((function(t){var a,n;return Object(s.a)(Object(s.a)({},t),{},{startDate:e?null===(a=e[0])||void 0===a?void 0:a._d:null,endDate:e?null===(n=e[1])||void 0===n?void 0:n._d:null})}))}}))),g.a.createElement(o.a,{gutter:16,style:{marginTop:".5em"}},g.a.createElement(l.a,{span:8},"Condition: ",g.a.createElement("br",null),g.a.createElement(i.a,{style:{width:"100%"},placeholder:"Select Condition",size:"middle",mode:"multiple",onChange:function(e){return he((function(t){return Object(s.a)(Object(s.a)({},t),{},{condition:e})}))},options:fe.data.map((function(e){return{label:e.name,value:e.name}}))})),g.a.createElement(l.a,{span:8},"Attributes: ",g.a.createElement("br",null),g.a.createElement(i.a,{style:{width:"100%"},placeholder:oe.isLoading?"Loading..":"Select Attribute",size:"middle",mode:"multiple",onChange:function(e){return he((function(t){return Object(s.a)(Object(s.a)({},t),{},{attributes:e})}))},options:oe.data.map((function(e){return{label:e.attribute_name,value:e.id}}))})),g.a.createElement(l.a,{span:8},"Price: ",g.a.createElement("br",null),g.a.createElement(c.a.Group,{compact:!0,size:"default"},g.a.createElement(c.a,{type:"number",placeholder:"Min",style:{width:"50%"},onBlur:function(e){he((function(t){var a;return Object(s.a)(Object(s.a)({},t),{},{minPrice:null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.value})}))}}),g.a.createElement(c.a,{type:"number",placeholder:"Max",style:{width:"50%"},onBlur:function(e){he((function(t){var a;return Object(s.a)(Object(s.a)({},t),{},{maxPrice:null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.value})}))}}))))),g.a.createElement("span",{className:"psp_list"},g.a.createElement(r.a,{className:"table-responsive",columns:Ee,rowKey:"id",size:"small",dataSource:R,rowClassName:function(e,t){return t%2==0?"":"altTableClass"},pagination:{defaultPageSize:x.a.PRODUCTS_PER_PAGE,total:R.length,showTotal:function(e,t){return"".concat(t[0],"-").concat(t[1]," of ").concat(e," items")}}}))))))))}}}]);