{"version":3,"sources":["container/permission/ListPermission.js"],"names":["ListPermission","viewPermission","dispatch","useDispatch","useState","data","loading","error","permissions","setPermissions","searchText","setSearchText","filteredPermissions","setFilteredPermissions","useEffect","apolloClient","query","authQuery","GET_ALL_ROLES_PERMISSION","context","headers","TENANTID","process","Authorization","Cookies","get","then","res","getAllRolesPermission","isAuth","logOut","s","catch","err","finally","columns","title","dataIndex","key","sorter","a","b","roles_permission_name","toUpperCase","roles_permission_slug","align","width","roles_permission_status","filters","text","value","onFilter","record","render","defaultChecked","onChange","checked","variables","id","mutate","mutation","authMutation","UPDATE_ROLES_PERMISSION","updateRolesPermission","status","toast","message","success","console","log","handleStatusChange","to","name","style","margin","color","buttons","className","size","type","icon","gutter","sm","xs","headless","placeholder","prefix","e","target","filter","permission","toLowerCase","includes","rowKey","dataSource","rowClassName","index","pagination","defaultPageSize","config","PERMISSIONS_PER_PAGE","total","length","showTotal","range"],"mappings":"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","file":"static/js/61.de7f01f6.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { SearchOutlined } from '@ant-design/icons';\nimport { Row, Col, Spin, Input, Table, Switch } from 'antd';\nimport FeatherIcon from 'feather-icons-react';\nimport { PageHeader } from '../../components/page-headers/page-headers';\nimport { Main } from '../styled';\nimport { Cards } from '../../components/cards/frame/cards-frame';\nimport { Button } from '../../components/buttons/buttons';\nimport { Link } from 'react-router-dom';\nimport apolloClient, { authMutation, authQuery } from '../../utility/apollo';\nimport Cookies from 'js-cookie';\nimport FontAwesome from 'react-fontawesome';\nimport { toast } from 'react-toastify';\nimport config from '../../config/config';\nimport { logOut } from '../../redux/authentication/actionCreator';\nimport { useDispatch } from 'react-redux';\nimport { viewPermission } from '../../utility/utility';\n\n\n\nconst ListPermission = () => {\n    viewPermission('permission');\n    const dispatch = useDispatch();\n    const [permissions, setPermissions] = useState({ data: [], loading: true, error: '' })\n    const [searchText, setSearchText] = useState('');\n    const [filteredPermissions, setFilteredPermissions] = useState([]);\n\n    useEffect(() => {\n        apolloClient.query({\n            query: authQuery.GET_ALL_ROLES_PERMISSION,\n            context: {\n                headers: {\n                    TENANTID: process.env.REACT_APP_TENANTID,\n                    Authorization: Cookies.get('psp_t')\n                }\n            }\n        }).then(res => {\n\n            const data = res?.data?.getAllRolesPermission\n\n            if (!data?.isAuth) return dispatch(logOut())\n            setPermissions(s => ({ ...s, data: data?.data, error: '' }))\n\n        }).catch(err => {\n            setPermissions(s => ({ ...s, error: 'Something went Wrong.!! ' }))\n        }).finally(() => {\n            setPermissions(s => ({ ...s, loading: false }))\n        })\n\n    }, []);\n\n    const handleStatusChange = (record, checked) => {\n        const variables = { data: { id: record.id, roles_permission_status: checked } }\n\n        apolloClient.mutate({\n            mutation: authMutation.UPDATE_ROLES_PERMISSION,\n            variables,\n            context: {\n                headers: {\n                    TENANTID: process.env.REACT_APP_TENANTID,\n                    Authorization: Cookies.get('psp_t')\n                }\n            }\n        }).then(res => {\n            const data = res?.data?.updateRolesPermission\n            if (!data?.status) return toast.error(data?.message)\n            toast.success(`${record.roles_permission_name} Permission Status updated successfully.`)\n        }).catch(err => {\n            console.log(\"error on status change: \", err)\n            toast.error(`Something went wrong!!`)\n        })\n\n    }\n\n    const columns = [\n        {\n            title: 'Permission Name',\n            dataIndex: 'roles_permission_name',\n            key: 'roles_permission_name',\n            sorter: (a, b) => a.roles_permission_name.toUpperCase() > b.roles_permission_name.toUpperCase() ? 1 : -1,\n        },\n        {\n            title: 'Permission Alias',\n            dataIndex: 'roles_permission_slug',\n            key: 'roles_permission_slug',\n            sorter: (a, b) => a.roles_permission_slug.toUpperCase() > b.roles_permission_slug.toUpperCase() ? 1 : -1,\n        },\n        {\n            title: 'Status',\n            dataIndex: 'roles_permission_status',\n            key: 'roles_permission_status',\n            align: 'middle',\n            width: 120,\n            sorter: (a, b) => (a.roles_permission_status === b.roles_permission_status) ? 0 : a.roles_permission_status ? -1 : 1,\n            filters: [\n                {\n                    text: 'Active',\n                    value: true,\n                },\n                {\n                    text: 'Inactive',\n                    value: false,\n                }\n            ],\n            onFilter: (value, record) => record.roles_permission_status === value,\n            render: (text, record) => (\n                <Switch defaultChecked={text} title='Status' onChange={checked => handleStatusChange(record, checked)} />\n            )\n        },\n        {\n            title: 'Action',\n            dataIndex: 'action',\n            align: 'right',\n            render: (text, record) => (\n                <>\n                    <Link to={`/admin/permission/add?id=${record.id}`}>\n                        <FontAwesome name=\"edit\" style={{ margin: \".5em 1em\", color: '#5F63F2' }} />\n                    </Link>\n                </>\n            ),\n            key: 'last_name',\n        },\n    ]\n\n    const onChangeSearch = e => {\n        const value = e.target.value\n        setSearchText(value)\n        setFilteredPermissions(permissions.data.filter(permission => permission?.roles_permission_name.toLowerCase().includes(value.toLowerCase())))\n    }\n\n\n    return (\n        <>\n            <PageHeader\n                title=\"Permissions\"\n                buttons={[\n                    <div key=\"1\" className=\"page-header-actions\">\n                        <Link to=\"/admin/permission/add\">\n                            <Button size=\"small\" title=\"Add Permission\" type=\"primary\">\n                                <FeatherIcon icon=\"file-plus\" />\n                            </Button>\n                        </Link>\n                    </div>\n                ]}\n            />\n            <Main>\n                <Row gutter={25}>\n                    <Col sm={24} xs={24}>\n                        <Cards headless>\n                            {permissions.loading ?\n                                <div className=\"spin\">\n                                    <Spin />\n                                </div>\n                                :\n                                permissions.error ?\n                                    <p>{permissions.error}</p>\n                                    :\n                                    <>\n                                        <Input placeholder=\"Search Permission...\" prefix={<SearchOutlined />} onChange={onChangeSearch} />\n                                        <br /><br />\n\n                                        <span className={\"psp_list\"} >\n                                            <Table\n                                                className=\"table-responsive\"\n                                                columns={columns}\n                                                rowKey={'id'}\n                                                size=\"small\"\n                                                dataSource={searchText ? filteredPermissions : permissions.data}\n                                                rowClassName={(record, index) => (index % 2 === 0 ? \"\" : \"altTableClass\")}\n                                                pagination={{\n                                                    defaultPageSize: config.PERMISSIONS_PER_PAGE,\n                                                    total: searchText ? filteredPermissions.length : permissions.length,\n                                                    showTotal: (total, range) => `${range[0]}-${range[1]} of ${total} items`,\n                                                }}\n                                            />\n                                        </span>\n                                    </>\n                            }\n\n                        </Cards>\n                    </Col>\n                </Row>\n            </Main>\n        </>\n    );\n};\n\nexport default ListPermission;\n"],"sourceRoot":""}