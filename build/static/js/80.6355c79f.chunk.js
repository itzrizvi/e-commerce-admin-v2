(this.webpackJsonpprime_server_parts=this.webpackJsonpprime_server_parts||[]).push([[80],{1040:function(e,t,a){"use strict";a.r(t);a(132);var n=a(63),r=(a(133),a(47)),i=(a(201),a(65)),d=(a(373),a(303)),l=(a(134),a(73)),o=a(92),u=a(60),c=a(8),s=(a(200),a(27)),m=a(14),p=(a(119),a(43)),f=a(0),y=a.n(f),h=a(120),E=a(101),v=a(100),b=a(99),g=a(59),j=a(10),O=a(168),_=a.n(O),A=a(29),x=a(71),I=a.n(x),S=a(32),T=a(23),C=(a(143),a(74)),D=(a(93),a(44)),N=(a(305),a(144)),V=(a(155),a(33)),k=a(22),w=a.n(k),q=a(277),P=function(e){var t=e.defaultBilling,a=e.initialAddressData,n=e.billingAddresses,r=e.setBillingAddresses,i=e.setDefaultBilling,l=Object(f.useState)("US"),u=Object(m.a)(l,2),s=u[0],h=u[1],E=Object(f.useState)([]),v=Object(m.a)(E,2),b=v[0],g=v[1],j=Object(f.useState)([]),O=Object(m.a)(j,2),_=O[0],x=O[1];Object(f.useEffect)((function(){A.j.query({query:q.a.GET_STATE_LISTS,variables:{query:{code:s}},context:{headers:{TENANTID:"100001"}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getStateList;(null===a||void 0===a?void 0:a.status)&&x(null===a||void 0===a?void 0:a.data)}))}),[s]),Object(f.useEffect)((function(){A.j.query({query:q.a.GET_COUNTRY_LIST,context:{headers:{TENANTID:"100001"}}}).then((function(e){var t=e.data.getCountryList;if(!t.status)return!0;g(null===t||void 0===t?void 0:t.data)}))}),[]);var I=[{title:"Country",dataIndex:["countryCode","name"],key:"name ",render:function(e,t){return y.a.createElement(V.a,{style:{width:"100%"},placeholder:"Country",defaultValue:e,options:null===b||void 0===b?void 0:b.map((function(e){return{label:e.name,value:e.code}})),onSelect:function(e,a){t.country=e,h(e)}})}},{title:"Address 1",dataIndex:"address1",key:"address1",width:200,render:function(e,t){return y.a.createElement(p.a,{defaultValue:e,type:"text",placeholder:"Address 1",onChange:function(e){return t.address1=e.target.value}})}},{title:"Address 2",dataIndex:"address2",key:"address2",width:200,render:function(e,t){return y.a.createElement(p.a,{defaultValue:e,type:"text",placeholder:"Address 2",onChange:function(e){return t.address2=e.target.value}})}},{title:"City",dataIndex:"city",key:"city",render:function(e,t){return y.a.createElement(p.a,{defaultValue:e,type:"text",placeholder:"City",onChange:function(e){return t.city=e.target.value}})}},{title:"State",dataIndex:"state",key:"state",width:150,render:function(e,t){return y.a.createElement(V.a,{style:{width:"100%"},placeholder:"State",defaultValue:e,options:null===_||void 0===_?void 0:_.map((function(e){return{label:e.state,value:e.abbreviation}})),onSelect:function(e){return t.state=e}})}},{title:"Zip Code",dataIndex:"zip_code",key:"zip_code",render:function(e,t){return y.a.createElement(p.a,{defaultValue:e,type:"text",placeholder:"Zip Code",onChange:function(e){return t.zip_code=e.target.value}})}},{title:"Country",dataIndex:"country ",key:"country ",render:function(e,t){return y.a.createElement(p.a,{defaultValue:t.country,type:"text",placeholder:"Country",onChange:function(e){return t.country=e.target.value}})}},{title:"Status",dataIndex:"status",key:"status",align:"right",render:function(e,t){return y.a.createElement(d.a,{defaultChecked:e,title:"Status",onChange:function(e){return t.status=e}})}},{title:"Default",dataIndex:"isDefault",key:"isDefault",align:"right",render:function(e,a){return y.a.createElement(N.a,{checked:t===a.id,onChange:function(e){return i(a.id)}})}},{title:"Action",dataIndex:"action",key:"action",render:function(e,t){return y.a.createElement(D.a,{size:"",title:"Remove",type:"danger",onClick:function(){return S(t.id)}},y.a.createElement(w.a,{icon:"trash-2"}))}}],S=function(e){r((function(t){return t.filter((function(t){return t.id!==e}))}))};return y.a.createElement("div",null,y.a.createElement(C.a,{columns:I,pagination:!1,rowKey:"id",size:"small",dataSource:n}),y.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"10px",marginBottom:"10px"}},y.a.createElement(D.a,{title:"Add Address",htmlType:"button",type:"primary",onClick:function(){r((function(e){return[].concat(Object(o.a)(e),[Object(c.a)(Object(c.a)({},a),{},{id:(new Date).getTime()})])}))},style:{marginRight:".5em"}},y.a.createElement(w.a,{icon:"plus"}))))},z=function(e){var t=e.defaultShipping,a=e.initialAddressData,n=e.shippingAddresses,r=e.setShippingAddresses,i=e.setDefaultShipping,l=Object(f.useState)("US"),u=Object(m.a)(l,2),s=u[0],h=u[1],E=Object(f.useState)([]),v=Object(m.a)(E,2),b=v[0],g=v[1],j=Object(f.useState)([]),O=Object(m.a)(j,2),_=O[0],x=O[1];Object(f.useEffect)((function(){A.j.query({query:q.a.GET_STATE_LISTS,variables:{query:{code:s}},context:{headers:{TENANTID:"100001"}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getStateList;(null===a||void 0===a?void 0:a.status)&&x(null===a||void 0===a?void 0:a.data)}))}),[s]),Object(f.useEffect)((function(){A.j.query({query:q.a.GET_COUNTRY_LIST,context:{headers:{TENANTID:"100001"}}}).then((function(e){var t=e.data.getCountryList;if(!t.status)return!0;g(null===t||void 0===t?void 0:t.data)}))}),[]);var I=[{title:"Country",dataIndex:["countryCode","name"],key:"name ",render:function(e,t){return y.a.createElement(V.a,{style:{width:"100%"},placeholder:"Country",defaultValue:e,options:null===b||void 0===b?void 0:b.map((function(e){return{label:e.name,value:e.code}})),onSelect:function(e,a){t.country=e,h(e)}})}},{title:"Address 1",dataIndex:"address1",key:"address1",width:200,render:function(e,t){return y.a.createElement(p.a,{defaultValue:e,type:"text",placeholder:"Address 1",onChange:function(e){return t.address1=e.target.value}})}},{title:"Address 2",dataIndex:"address2",key:"address2",width:200,render:function(e,t){return y.a.createElement(p.a,{defaultValue:e,type:"text",placeholder:"Address 2",onChange:function(e){return t.address2=e.target.value}})}},{title:"City",dataIndex:"city",key:"city",render:function(e,t){return y.a.createElement(p.a,{defaultValue:e,type:"text",placeholder:"City",onChange:function(e){return t.city=e.target.value}})}},{title:"State",dataIndex:"state",key:"state",width:150,render:function(e,t){return y.a.createElement(V.a,{style:{width:"100%"},placeholder:"State",defaultValue:e,options:null===_||void 0===_?void 0:_.map((function(e){return{label:e.state,value:e.abbreviation}})),onSelect:function(e){return t.state=e}})}},{title:"Zip Code",dataIndex:"zip_code",key:"zip_code",render:function(e,t){return y.a.createElement(p.a,{defaultValue:e,type:"text",placeholder:"Zip Code",onChange:function(e){return t.zip_code=e.target.value}})}},{title:"Status",dataIndex:"status",key:"status",align:"right",render:function(e,t){return y.a.createElement(d.a,{defaultChecked:e,title:"Status",onChange:function(e){return t.status=e}})}},{title:"Default",dataIndex:"isDefault",key:"isDefault",align:"right",render:function(e,a){return y.a.createElement(N.a,{name:"isDefault",checked:t===a.id,onChange:function(e){return i(a.id)}})}},{title:"Action",dataIndex:"action",key:"action",render:function(e,t){return y.a.createElement(D.a,{size:"",title:"Remove",type:"danger",onClick:function(){return S(t.id)}},y.a.createElement(w.a,{icon:"trash-2"}))}}],S=function(e){r((function(t){return t.filter((function(t){return t.id!==e}))}))};return y.a.createElement("div",null,y.a.createElement(C.a,{columns:I,pagination:!1,rowKey:"id",size:"small",dataSource:n}),y.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"10px",marginBottom:"10px"}},y.a.createElement(D.a,{title:"Add Address",htmlType:"button",type:"primary",onClick:function(){r((function(e){return[].concat(Object(o.a)(e),[Object(c.a)(Object(c.a)({},a),{},{id:(new Date).getTime()})])}))},style:{marginRight:".5em"}},y.a.createElement(w.a,{icon:"plus"}))))},L=["updatedAt","createdAt","__typename","type","isDefault"],R=["parent_id","isNew","id","isDefault"],F=["parent_id","isNew","isDefault","id"],B=p.a.TextArea;t.default=function(){Object(T.c)("vendor");var e=Object(g.useLocation)().search,t=_.a.parse(e),a=Object(g.useHistory)(),O=Object(f.useState)({data:[],isLoading:!0}),x=Object(m.a)(O,2),C=x[0],D=x[1],N=Object(f.useState)(!0),V=Object(m.a)(N,2),k=V[0],w=V[1],q=Object(f.useState)(!1),G=Object(m.a)(q,2),U=G[0],X=G[1],Z=Object(f.useState)(null),J=Object(m.a)(Z,2),K=J[0],Y=J[1],H=Object(f.useState)(null),M=Object(m.a)(H,2),Q=M[0],W=M[1],$=s.a.useForm(),ee=Object(m.a)($,1)[0],te=Object(f.useState)(!1),ae=Object(m.a)(te,2),ne=ae[0],re=ae[1],ie=Object(f.useState)(null),de=Object(m.a)(ie,2),le=de[0],oe=de[1],ue=Object(f.useState)(!1),ce=Object(m.a)(ue,2),se=ce[0],me=ce[1],pe={id:(new Date).getTime(),parent_id:"",address1:"",address2:"",country:"",city:"",state:"",zip_code:"",email:"",fax:"",phone:"",status:!0,isDefault:!1,isNew:!0},fe=Object(f.useState)([pe]),ye=Object(m.a)(fe,2),he=ye[0],Ee=ye[1],ve=Object(f.useState)([pe]),be=Object(m.a)(ve,2),ge=be[0],je=be[1];Object(f.useEffect)((function(){(null===t||void 0===t?void 0:t.id)&&A.j.query({query:A.p.GET_SINGLE_VENDOR,variables:{query:{id:parseInt(t.id)}},context:{headers:{TENANTID:"100001",Authorization:I.a.get("psp_t")}}}).then((function(e){var t,a,n,r=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getSingleVendor;if(null===r||void 0===r?void 0:r.status){pe.parent_id=null===r||void 0===r||null===(a=r.data)||void 0===a?void 0:a.id,D((function(e){return Object(c.a)(Object(c.a)({},e),{},{data:null===r||void 0===r?void 0:r.data,error:""})}));var i=[],d=[];null===r||void 0===r||null===(n=r.data)||void 0===n||n.addresses.forEach((function(e){e.updatedAt,e.createdAt,e.__typename,e.type;var t,a=e.isDefault,n=Object(u.a)(e,L),l=Object(c.a)({isDefault:!1,isNew:!1,parent_id:null===r||void 0===r||null===(t=r.data)||void 0===t?void 0:t.id},n);return"billing"===e.type?(a&&Y(e.id),i.push(l)):"shipping"===e.type?(a&&W(e.id),d.push(l)):void 0})),Ee(i),je(d)}})).catch((function(e){D((function(e){return Object(c.a)(Object(c.a)({},e),{},{error:"Something went Wrong.!! "})}))})).finally((function(){D((function(e){return Object(c.a)(Object(c.a)({},e),{},{isLoading:!1})}))}))}),[null===t||void 0===t?void 0:t.id]);return Object(f.useEffect)((function(){if(ne){var e=he.map((function(e){e.parent_id;var t=e.isNew,a=e.id,n=(e.isDefault,Object(u.a)(e,R));return Object(c.a)(Object(c.a)({isDefault:K===a,parent_id:le,isNew:t},n),!t&&{id:a})})),t=ge.map((function(e){e.parent_id;var t=e.isNew,a=(e.isDefault,e.id),n=Object(u.a)(e,F);return Object(c.a)(Object(c.a)({isDefault:Q===a,parent_id:le,isNew:t},n),!t&&{id:a})}));["billing","shipping"].forEach((function(n){X(!0),A.j.mutate({mutation:A.o.UPDATE_VENDOR_ADDRESS,variables:{data:{ref_id:le,type:n,addresses:Object(o.a)("billing"===n?e:t)}},context:{headers:{TENANTID:"100001",Authorization:I.a.get("psp_t")}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.updateVendorAddress;null===a||void 0===a||a.status})).catch((function(e){me(!0)})).finally((function(e){X(!1),"shipping"===n&&(se||(S.b.success("Vendor Updated Successfully."),setTimeout((function(){a.push("/admin/vendor/list")}),[2e3])))}))}))}}),[ne]),y.a.createElement(y.a.Fragment,null,y.a.createElement(h.a,{title:t.id?"Manage Vendor | Edit ".concat(C.data.company_name?"(".concat(C.data.company_name,")"):""):"Add Vendor"}),y.a.createElement(E.b,null,y.a.createElement(n.a,{gutter:25},y.a.createElement(r.a,{sm:24,xs:24},y.a.createElement(v.a,{headless:!0},t.id&&C.isLoading?y.a.createElement("div",{div:!0,className:"spin"},y.a.createElement(l.a,null)):y.a.createElement(s.a,{style:{width:"100%"},form:ee,name:"addVendor",onFinish:function(e){var a=Object(c.a)(Object(c.a)({},e),{},{status:k}),n=he.find((function(e){var t=e.id,a=e.address1,n=e.country,r=e.city,i=e.state,d=e.zip_code,l=e.address2;return!(t&&a&&n&&r&&i&&d&&l)}));if(null===n||void 0===n?void 0:n.id)return S.b.warning("Enter Billing Address Correctly!");var r=ge.find((function(e){var t=e.id,a=e.address1,n=e.country,r=e.city,i=e.state,d=e.zip_code,l=e.address2;return!(t&&a&&n&&r&&i&&d&&l)}));if(null===r||void 0===r?void 0:r.id)return S.b.warning("Enter Shipping Address Correctly!");X(!0),t.id?A.j.mutate({mutation:A.o.UPDATE_VENDOR,variables:{data:Object(c.a)(Object(c.a)({},a),{},{id:parseInt(t.id)})},context:{headers:{TENANTID:"100001",Authorization:I.a.get("psp_t")}}}).then((function(e){var a,n=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.updateVendor;if(!n.status)return S.b.error(n.message);oe(parseInt(null===t||void 0===t?void 0:t.id)),re(!0)})).catch((function(e){console.log("got error on update vendor",e),me(!0)})).finally((function(){X(!1)})):A.j.mutate({mutation:A.o.CREATE_VENDOR,variables:{data:a},context:{headers:{TENANTID:"100001",Authorization:I.a.get("psp_t")}},refetchQueries:[{query:A.p.GET_ALL_VENDOR,context:{headers:{TENANTID:"100001",Authorization:I.a.get("psp_t")}},fetchPolicy:"network-only"},["getAllVendor"]]}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.createVendor;if(!a.status)return S.b.error(a.message);oe(parseInt(a.id)),re(!0)})).catch((function(e){X(!1),console.log("got error on add vendor",e),me(!0)}))},onFinishFailed:function(e){return console.log("form error info:\n",e)},labelCol:{span:4},initialValues:t.id?{company_name:C.data.company_name,contact_person:C.data.contact_person,email:C.data.email,description:C.data.description,phone_number:C.data.phone_number,EIN_no:C.data.EIN_no,TAX_ID:C.data.TAX_ID,FAX_no:C.data.FAX_no}:null},y.a.createElement(i.a,null,y.a.createElement(i.a.TabPane,{tab:"General",key:"general"},y.a.createElement(s.a.Item,{rules:[{required:!0,max:30,message:"Please enter Vendor Company Name"}],name:"company_name",label:"Company Name"},y.a.createElement(p.a,{placeholder:"Enter Vendor Company Name"})),y.a.createElement(s.a.Item,{rules:[{required:!0,max:30,message:"Please enter Vendor Contact Person"}],label:"Contact Person",name:"contact_person"},y.a.createElement(p.a,{placeholder:"Enter Contact Person"})),y.a.createElement(s.a.Item,{rules:[{required:!0,max:30,message:"Please enter Email"}],name:"email",label:"Email"},y.a.createElement(p.a,{placeholder:"Enter Vendor Email",type:"email"})),y.a.createElement(s.a.Item,{rules:[{required:!0,max:30,message:"Please enter Phone Number"}],name:"phone_number",label:"Phone"},y.a.createElement(p.a,{placeholder:"Enter Vendor Phone Number"})),y.a.createElement(s.a.Item,{rules:[{required:!0,max:30,message:"Please enter Fax No"}],name:"FAX_no",label:"Fax"},y.a.createElement(p.a,{placeholder:"Enter Vendor Fax"})),y.a.createElement(s.a.Item,{rules:[{required:!0,max:30,message:"Please enter EIN No"}],name:"EIN_no",label:"EIN"},y.a.createElement(p.a,{placeholder:"Enter Vendor EIN Number"})),y.a.createElement(s.a.Item,{rules:[{required:!0,max:30,message:"Please enter Fax Id"}],name:"TAX_ID",label:"Tax Id"},y.a.createElement(p.a,{placeholder:"Enter Vendor Tax Id"})),y.a.createElement(s.a.Item,{rules:[{required:!0,message:"Please enter Vendor Description"}],name:"description",label:"Description"},y.a.createElement(B,{rows:4,placeholder:"Enter Vendor Description"})),y.a.createElement(s.a.Item,{label:"Vendor Status"},y.a.createElement(d.a,{checked:k,onChange:function(e){return w(e)}}))),y.a.createElement(i.a.TabPane,{tab:"Billing Address",key:"billing_address"},y.a.createElement(P,{defaultBilling:K,initialAddressData:pe,billingAddresses:he,setBillingAddresses:Ee,setDefaultBilling:Y})),y.a.createElement(i.a.TabPane,{tab:"Shipping Address",key:"shipping_address"},y.a.createElement(z,{defaultShipping:Q,initialAddressData:pe,shippingAddresses:ge,setShippingAddresses:je,setDefaultShipping:W}))),y.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"3em"}},y.a.createElement(s.a.Item,null,y.a.createElement(b.a,{loading:U,size:"default",htmlType:"submit",type:"primary",raised:!0},U?"Processing":"Save"),y.a.createElement(j.b,{to:"/admin/vendor/list"},y.a.createElement(b.a,{style:{marginLeft:10},type:"light",size:"default"},"Cancel"))))))))))}}}]);