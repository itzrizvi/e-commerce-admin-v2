(this.webpackJsonpprime_server_parts=this.webpackJsonpprime_server_parts||[]).push([[72],{1015:function(e,t,a){"use strict";a.r(t);a(200);var n=a(96),o=(a(201),a(74)),r=(a(312),a(219)),u=(a(643),a(644)),c=(a(202),a(64)),l=(a(166),a(97)),m=a(65),s=a(9),i=(a(287),a(53)),p=a(23),d=(a(148),a(45)),_=a(0),E=a.n(_),b=a(218),g=a(165),f=a(164),h=a(217),O=a(59),v=a(12),C=a(315),j=a.n(C),y=a(71),I=a(69),x=a.n(I),A=a(51),S=a(379),T=a.n(S),D=a(22),P=a(115),N=["coupon_startdate","coupon_enddate","coupon_maxamount","coupon_minamount","coupon_amount","coupon_sortorder"],q=d.a.TextArea;t.default=function(){Object(D.f)("coupon");var e=Object(O.useLocation)().search,t=j.a.parse(e),a=Object(O.useHistory)(),C=Object(_.useState)({data:[],isLoading:!0}),I=Object(p.a)(C,2),S=I[0],w=I[1],M=Object(_.useState)(""),F=Object(p.a)(M,2),G=F[0],L=F[1],k=Object(_.useState)(!0),z=Object(p.a)(k,2),U=z[0],W=z[1],J=Object(_.useState)(!1),R=Object(p.a)(J,2),H=R[0],V=R[1],B=i.a.useForm(),K=Object(p.a)(B,1)[0];Object(_.useEffect)((function(){t.id&&y.j.query({query:y.g.GET_SINGLE_COUPON,variables:{query:{coupon_id:parseInt(t.id)}},context:{headers:{TENANTID:"100001",Authorization:x.a.get("psp_t")}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getSingleCoupon;(null===a||void 0===a?void 0:a.status)&&(w((function(e){return Object(s.a)(Object(s.a)({},e),{},{data:null===a||void 0===a?void 0:a.data,error:""})})),L(a.data.coupon_type))})).catch((function(e){w((function(e){return Object(s.a)(Object(s.a)({},e),{},{error:"Something went Wrong.!! "})}))})).finally((function(){w((function(e){return Object(s.a)(Object(s.a)({},e),{},{isLoading:!1})}))}))}),[]);return E.a.createElement(E.a.Fragment,null,E.a.createElement(b.a,{title:t.id?"Manage Coupon | Edit ".concat(S.isLoading?"":"(".concat(S.data.coupon_name,")")):"Add Coupon"}),E.a.createElement(g.b,null,E.a.createElement(n.a,{gutter:25},E.a.createElement(o.a,{sm:24,xs:24},E.a.createElement(f.a,{headless:!0},t.id&&S.isLoading?E.a.createElement("div",{div:!0,className:"spin"},E.a.createElement(l.a,null)):E.a.createElement(i.a,{style:{width:"100%"},form:K,name:"addRole",onFinish:function(e){var n=e.coupon_startdate,o=e.coupon_enddate,r=e.coupon_maxamount,u=e.coupon_minamount,c=e.coupon_amount,l=e.coupon_sortorder,i=Object(m.a)(e,N),p=Object(s.a)(Object(s.a)({},i),{},{coupon_startdate:new Date(n).toGMTString(),coupon_enddate:new Date(o).toGMTString(),coupon_status:U,coupon_type:G,coupon_maxamount:parseInt(r),coupon_minamount:parseInt(u),coupon_amount:parseInt(c),coupon_sortorder:parseInt(l)});if(V(!0),t.id){var d={data:Object(s.a)({coupon_id:parseInt(t.id)},p)};console.log(d),y.j.mutate({mutation:y.f.UPDATE_COUPON,variables:d,context:{headers:{TENANTID:"100001",Authorization:x.a.get("psp_t")}}}).then((function(t){var n;if(!(null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.updateCoupon).status)return Object(P.a)();setTimeout((function(){a.push("/admin/products/coupon")}),1e3),A.b.success("".concat(e.customer_group_name," Group Updated successfully"))})).catch((function(e){return console.log("got error on addCustomerGroup",e),A.b.error("Something Went wrong !!")})).finally((function(){V(!1)}))}else{var _={data:p};console.log(_),y.j.mutate({mutation:y.f.CREATE_COUPON,variables:_,context:{headers:{TENANTID:"100001",Authorization:x.a.get("psp_t")}}}).then((function(t){var n;if(!(null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.createCoupon).status)return Object(P.a)();setTimeout((function(){a.push("/admin/products/coupon")}),1e3),A.b.success("".concat(e.coupon_name," coupon added successfully"))})).catch((function(e){return console.log("Error on add coupon",e),A.b.error("Something Went wrong !!")})).finally((function(){V(!1)}))}},onFinishFailed:function(e){return console.log("form error info:\n",e)},labelCol:{span:4},initialValues:t.id?{coupon_name:S.data.coupon_name,coupon_description:S.data.coupon_description,coupon_code:S.data.coupon_code,coupon_amount:S.data.coupon_amount,coupon_minamount:S.data.coupon_minamount,coupon_maxamount:S.data.coupon_maxamount,coupon_startdate:T()(parseInt(S.data.coupon_startdate)),coupon_enddate:T()(parseInt(S.data.coupon_enddate)),coupon_sortorder:S.data.coupon_sortorder}:null},E.a.createElement(i.a.Item,{rules:[{required:!0,max:30,message:"Please enter Coupon Name"}],name:"coupon_name",label:"Coupon Name"},E.a.createElement(d.a,{placeholder:"Enter Coupon Name"})),E.a.createElement(i.a.Item,{rules:[{required:!0,message:"Please enter Coupon Description"}],name:"coupon_description",label:"Description"},E.a.createElement(q,{rows:4,placeholder:"Enter Coupon Description"})),E.a.createElement(i.a.Item,{rules:[{required:!0,max:30,message:"Please enter Coupon CODE"}],name:"coupon_code",label:"CODE"},E.a.createElement(d.a,{placeholder:"Enter Coupon CODE"})),E.a.createElement(i.a.Item,{rules:[{required:!0,max:30,message:"Please enter Coupon Type"}],label:"Type"},E.a.createElement(c.a,{value:G,onChange:function(e){return L(e)},placeholder:"Select Coupon type"},E.a.createElement(c.a.Option,{key:1,value:"percentage"},"Percentage"),E.a.createElement(c.a.Option,{key:2,value:"flat"},"Flat"))),E.a.createElement(i.a.Item,{rules:[{required:!0,message:"Please enter Coupon Amount"}],name:"coupon_amount",label:"Amount"},E.a.createElement(d.a,{type:"number",placeholder:"Enter Coupon Amount"})),E.a.createElement(i.a.Item,{rules:[{required:!0,message:"Please enter Minimum Amount"}],name:"coupon_minamount",label:"Minimum Amount"},E.a.createElement(d.a,{type:"number",placeholder:"Enter Minimum Amount"})),E.a.createElement(i.a.Item,{rules:[{required:!0,message:"Please enter Maximum Amount"}],name:"coupon_maxamount",label:"Maximum Amount"},E.a.createElement(d.a,{type:"number",placeholder:"Enter Maximum Amount"})),E.a.createElement(i.a.Item,{rules:[{required:!0,message:"Please enter Start Date"}],name:"coupon_startdate",label:"Start Date"},E.a.createElement(u.a,null)),E.a.createElement(i.a.Item,{rules:[{required:!0,message:"Please enter End Date"}],name:"coupon_enddate",label:"End Date"},E.a.createElement(u.a,null)),E.a.createElement(i.a.Item,{rules:[{required:!0,message:"Please enter Sort order"}],name:"coupon_sortorder",label:"Sort order"},E.a.createElement(d.a,{type:"number",placeholder:"Enter sort order"})),E.a.createElement(i.a.Item,{label:"Coupon Status"},E.a.createElement(r.a,{checked:U,onChange:function(e){return W(e)}})),E.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"3em"}},E.a.createElement(i.a.Item,null,E.a.createElement(h.a,{loading:H,size:"default",htmlType:"submit",type:"primary",raised:!0},H?"Processing":"Save"),E.a.createElement(v.b,{to:"/admin/customers/group"},E.a.createElement(h.a,{type:"white",size:"large"},"Cancel"))))))))))}}}]);