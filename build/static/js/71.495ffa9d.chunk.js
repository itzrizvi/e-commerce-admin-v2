(this.webpackJsonpprime_server_parts=this.webpackJsonpprime_server_parts||[]).push([[71],{939:function(e,a,t){"use strict";t.r(a);t(200);var n=t(97),o=(t(201),t(74)),r=(t(314),t(218)),u=(t(642),t(645)),c=(t(202),t(63)),l=(t(166),t(98)),m=(t(288),t(69)),s=t(64),i=t(9),p=(t(289),t(52)),d=t(23),_=(t(148),t(45)),E=t(0),b=t.n(E),f=t(217),g=t(165),v=t(164),O=t(287),h=t(58),C=t(12),j=t(317),y=t.n(j),I=t(71),x=t(68),A=t.n(x),T=t(380),D=t.n(T),P=t(22),S=t(76),N=["coupon_startdate","coupon_enddate","coupon_maxamount","coupon_minamount","coupon_amount","coupon_sortorder"],q=_.a.TextArea;a.default=function(){Object(P.f)("coupon");var e=Object(h.useLocation)().search,a=y.a.parse(e),t=Object(h.useHistory)(),j=Object(E.useState)({data:[],isLoading:!0}),x=Object(d.a)(j,2),T=x[0],M=x[1],w=Object(E.useState)(""),F=Object(d.a)(w,2),L=F[0],k=F[1],z=Object(E.useState)(!0),G=Object(d.a)(z,2),U=G[0],J=G[1],R=Object(E.useState)(!1),H=Object(d.a)(R,2),V=H[0],B=H[1],K=p.a.useForm(),Q=Object(d.a)(K,1)[0];Object(E.useEffect)((function(){a.id&&I.j.query({query:I.g.GET_SINGLE_COUPON,variables:{query:{coupon_id:parseInt(a.id)}},context:{headers:{TENANTID:"100001",Authorization:A.a.get("psp_t")}}}).then((function(e){var a,t=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.getSingleCoupon;if(!(null===t||void 0===t?void 0:t.status))return Object(S.a)();M((function(e){return Object(i.a)(Object(i.a)({},e),{},{data:null===t||void 0===t?void 0:t.data,error:""})})),k(t.data.coupon_type)})).finally((function(){M((function(e){return Object(i.a)(Object(i.a)({},e),{},{isLoading:!1})}))}))}),[]);return b.a.createElement(b.a.Fragment,null,b.a.createElement(f.a,{title:a.id?"Manage Coupon | Edit ".concat(T.isLoading?"":"(".concat(T.data.coupon_name,")")):"Add Coupon"}),b.a.createElement(g.b,null,b.a.createElement(n.a,{gutter:25},b.a.createElement(o.a,{sm:24,xs:24},b.a.createElement(v.a,{headless:!0},a.id&&T.isLoading?b.a.createElement("div",{div:!0,className:"spin"},b.a.createElement(l.a,null)):b.a.createElement(p.a,{style:{width:"100%"},form:Q,name:"addRole",onFinish:function(e){var n=e.coupon_startdate,o=e.coupon_enddate,r=e.coupon_maxamount,u=e.coupon_minamount,c=e.coupon_amount,l=e.coupon_sortorder,p=Object(s.a)(e,N),d=Object(i.a)(Object(i.a)({},p),{},{coupon_startdate:new Date(n).toGMTString(),coupon_enddate:new Date(o).toGMTString(),coupon_status:U,coupon_type:L,coupon_maxamount:parseInt(r),coupon_minamount:parseInt(u),coupon_amount:parseInt(c),coupon_sortorder:parseInt(l)});if(B(!0),a.id){var _={data:Object(i.a)({coupon_id:parseInt(a.id)},d)};console.log(_),I.j.mutate({mutation:I.f.UPDATE_COUPON,variables:_,context:{headers:{TENANTID:"100001",Authorization:A.a.get("psp_t")}}}).then((function(a){var n,o=null===a||void 0===a||null===(n=a.data)||void 0===n?void 0:n.updateCoupon;if(!(null===o||void 0===o?void 0:o.status))return Object(S.a)();setTimeout((function(){t.push("/admin/products/coupon")}),1e3),m.b.success("".concat(e.customer_group_name," Group Updated successfully"))})).finally((function(){B(!1)}))}else{var E={data:d};console.log(E),I.j.mutate({mutation:I.f.CREATE_COUPON,variables:E,context:{headers:{TENANTID:"100001",Authorization:A.a.get("psp_t")}}}).then((function(a){var n,o=null===a||void 0===a||null===(n=a.data)||void 0===n?void 0:n.createCoupon;if(!(null===o||void 0===o?void 0:o.status))return Object(S.a)();setTimeout((function(){t.push("/admin/products/coupon")}),1e3),m.b.success("".concat(e.coupon_name," coupon added successfully"))})).finally((function(){B(!1)}))}},onFinishFailed:function(e){return console.log("form error info:\n",e)},labelCol:{span:4},initialValues:a.id?{coupon_name:T.data.coupon_name,coupon_description:T.data.coupon_description,coupon_code:T.data.coupon_code,coupon_amount:T.data.coupon_amount,coupon_minamount:T.data.coupon_minamount,coupon_maxamount:T.data.coupon_maxamount,coupon_startdate:D()(parseInt(T.data.coupon_startdate)),coupon_enddate:D()(parseInt(T.data.coupon_enddate)),coupon_sortorder:T.data.coupon_sortorder}:null},b.a.createElement(p.a.Item,{rules:[{required:!0,max:30,message:"Please enter Coupon Name"}],name:"coupon_name",label:"Coupon Name"},b.a.createElement(_.a,{placeholder:"Enter Coupon Name"})),b.a.createElement(p.a.Item,{rules:[{required:!0,message:"Please enter Coupon Description"}],name:"coupon_description",label:"Description"},b.a.createElement(q,{rows:4,placeholder:"Enter Coupon Description"})),b.a.createElement(p.a.Item,{rules:[{required:!0,max:30,message:"Please enter Coupon CODE"}],name:"coupon_code",label:"CODE"},b.a.createElement(_.a,{placeholder:"Enter Coupon CODE"})),b.a.createElement(p.a.Item,{rules:[{required:!0,max:30,message:"Please enter Coupon Type"}],label:"Type"},b.a.createElement(c.a,{value:L,onChange:function(e){return k(e)},placeholder:"Select Coupon type"},b.a.createElement(c.a.Option,{key:1,value:"percentage"},"Percentage"),b.a.createElement(c.a.Option,{key:2,value:"flat"},"Flat"))),b.a.createElement(p.a.Item,{rules:[{required:!0,message:"Please enter Coupon Amount"}],name:"coupon_amount",label:"Amount"},b.a.createElement(_.a,{type:"number",placeholder:"Enter Coupon Amount"})),b.a.createElement(p.a.Item,{rules:[{required:!0,message:"Please enter Minimum Amount"}],name:"coupon_minamount",label:"Minimum Amount"},b.a.createElement(_.a,{type:"number",placeholder:"Enter Minimum Amount"})),b.a.createElement(p.a.Item,{rules:[{required:!0,message:"Please enter Maximum Amount"}],name:"coupon_maxamount",label:"Maximum Amount"},b.a.createElement(_.a,{type:"number",placeholder:"Enter Maximum Amount"})),b.a.createElement(p.a.Item,{rules:[{required:!0,message:"Please enter Start Date"}],name:"coupon_startdate",label:"Start Date"},b.a.createElement(u.a,null)),b.a.createElement(p.a.Item,{rules:[{required:!0,message:"Please enter End Date"}],name:"coupon_enddate",label:"End Date"},b.a.createElement(u.a,null)),b.a.createElement(p.a.Item,{rules:[{required:!0,message:"Please enter Sort order"}],name:"coupon_sortorder",label:"Sort order"},b.a.createElement(_.a,{type:"number",placeholder:"Enter sort order"})),b.a.createElement(p.a.Item,{label:"Coupon Status"},b.a.createElement(r.a,{checked:U,onChange:function(e){return J(e)}})),b.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"3em"}},b.a.createElement(p.a.Item,null,b.a.createElement(O.a,{loading:V,size:"default",htmlType:"submit",type:"primary",raised:!0},V?"Processing":"Save"),b.a.createElement(C.b,{to:"/admin/customers/group"},b.a.createElement(O.a,{type:"white",size:"large"},"Cancel"))))))))))}}}]);