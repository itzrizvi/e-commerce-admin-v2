(this.webpackJsonpprime_server_parts=this.webpackJsonpprime_server_parts||[]).push([[67],{1007:function(e,t,a){"use strict";a.r(t);a(89);var n,r,i=a(32),l=(a(152),a(43)),c=(a(69),a(20)),o=(a(70),a(14)),u=(a(92),a(25)),d=(a(134),a(72)),s=(a(178),a(109)),p=a(6),m=a(7),b=a(9),v=(a(399),a(332)),f=a(0),g=a.n(f),h=a(26),E=a.n(h),y=a(142),O=a(108),j=a(107),_=a(71),A=a(654),D=a(218),S=a(12),x=a(22),I=a(28),P=a(153),T=a.n(P),w=a(93),C=a.n(w),L=a(50),k=a(136),N=a(248),z=a(15),U=a(30),Y=a(124),q=a.n(Y),F=a(135),M=a.n(F),R=v.a.RangePicker,G=!1,Q=null!==(n=C.a.get("permissions"))&&void 0!==n?n:"[]",W=JSON.parse(Q),J=!1;W.forEach((function(e){"product-all"===e.permission_name&&!0===e.read_access&&!0===e.edit_access&&(J=!0)}));t.default=function(){var e,t,a;Object(x.e)("product");var n=Object(f.useState)({data:[],isLoading:!1}),v=Object(b.a)(n,2),h=v[0],P=v[1],w=Object(f.useState)(!1),Y=Object(b.a)(w,2),F=Y[0],Q=Y[1],W=Object(f.useState)(!1),B=Object(b.a)(W,2),K=B[0],V=B[1],H=Object(f.useState)({data:[],isLoading:!0}),X=Object(b.a)(H,2),Z=X[0],$=X[1],ee=Object(f.useState)({data:[],isLoading:!0}),te=Object(b.a)(ee,2),ae=te[0],ne=te[1],re=Object(f.useState)({data:[],isLoading:!0}),ie=Object(b.a)(re,2),le=ie[0],ce=ie[1],oe=Object(f.useState)({data:[],isLoading:!0}),ue=Object(b.a)(oe,2),de=ue[0],se=ue[1],pe=Object(f.useState)(null),me=Object(b.a)(pe,2),be=me[0],ve=me[1],fe=Object(f.useState)(null),ge=Object(b.a)(fe,2),he=ge[0],Ee=ge[1],ye=Object(f.useState)(!0),Oe=Object(b.a)(ye,2),je=Oe[0],_e=Oe[1],Ae=Object(f.useState)({data:[],loading:!0,error:""}),De=Object(b.a)(Ae,2),Se=De[0],xe=De[1],Ie=Object(f.useState)(!1),Pe=Object(b.a)(Ie,2),Te=Pe[0],we=Pe[1],Ce=Object(f.useState)({availability:[],categories:[],condition:[],attributes:[],productrep:[],startDate:"",endDate:"",updatedStartDate:"",updatedEndDate:"",minPrice:"",maxPrice:"",searchQuery:""}),Le=Object(b.a)(Ce,2),ke=Le[0],Ne=Le[1];Object(f.useEffect)((function(){I.j.query({query:I.l.GET_ALL_CATEGORIES,context:{headers:{TENANTID:"100001"}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getAllCategories;if(a.status&&a.categories.length){var n=[];a.categories.forEach((function(e){var t=e.cat_name;n.push({cat_name:t,id:e.id}),e.subcategories&&e.subcategories.forEach((function(e){var a=e.cat_name;n.push({cat_name:"".concat(t," > ").concat(a),id:e.id}),e.subsubcategories&&e.subsubcategories.forEach((function(e){var r=e.cat_name;n.push({cat_name:"".concat(t," > ").concat(a," > ").concat(r),id:e.id})}))}))})),$({data:n,isLoading:!1})}})).catch((function(e){})),I.j.query({query:Object(z.d)(r||(r=Object(m.a)(["\n          query getAllAttributes {\n            getAllAttributes {\n              message\n              status\n              tenant_id\n              data {\n                id\n                attribute_name\n              }\n            }\n          }\n        "]))),context:{headers:{TENANTID:"100001",Authorization:C.a.get("psp_t")}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getAllAttributes;a.status&&ne({data:a.data,isLoading:!1})})),I.j.query({query:I.m.GET_ALL_AVAILABILITY,context:{headers:{TENANTID:"100001",Authorization:C.a.get("psp_t")}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getAllProductAvailabilityStatus;a.status&&ce({data:a.data,isLoading:!1})})),I.j.query({query:I.m.GET_ALL_CONDITIONS,context:{headers:{TENANTID:"100001",Authorization:C.a.get("psp_t")}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getAllProductCondition;a.status&&se({data:a.data,isLoading:!1})}))}),[]);var ze=[{title:"ID",dataIndex:"id",key:"id",width:70,ellipsis:!0,sorter:function(e,t){return e.id.toUpperCase()>t.id.toUpperCase()?1:-1}},{title:"Logo",dataIndex:"id",key:"id",width:70,render:function(e,t){return g.a.createElement(N.LazyLoadImage,{effect:"blur",width:"40",src:Object(k.renderImage)(t.id,t.prod_thumbnail,"product/image/thumbnail","128x128"),onError:k.errorImageSrc,alt:t.id})}},{title:"Product Name",dataIndex:"prod_name",key:"prod_name",ellipsis:!0,sorter:function(e,t){return e.prod_name.toUpperCase()>t.prod_name.toUpperCase()?1:-1}},{title:"Product SKU",dataIndex:"prod_sku",width:150,key:"prod_sku",ellipsis:!0,sorter:function(e,t){return e.prod_sku.toUpperCase()>t.prod_sku.toUpperCase()?1:-1}},{title:"Part NO",dataIndex:"prod_partnum",width:150,key:"prod_partnum",ellipsis:!0,sorter:function(e,t){return e.prod_partnum.toUpperCase()>t.prod_partnum.toUpperCase()?1:-1}},{title:"Status",dataIndex:"prod_status",key:"prod_status",width:110,align:"middle",sorter:function(e,t){return e.prod_status===t.prod_status?0:e.prod_status?-1:1},filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:function(e,t){return t.prod_status===e},render:function(e,t){return g.a.createElement(s.a,{defaultChecked:e,title:"Status",onChange:function(e){return function(e,t){I.j.mutate({mutation:I.k.UPDATE_PRODUCT,variables:{data:{prod_id:e.id,prod_status:t}},context:{headers:{TENANTID:"100001",Authorization:C.a.get("psp_t")}}}).then((function(t){var a,n=null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.updateProduct;if(!n.status)return U.b.error(n.message);U.b.success("".concat(e.prod_sku," status updated."))})).catch((function(e){return U.b.error("Something Went wrong !!")}))}(t,e)}})}},{title:"On Sale",dataIndex:"is_sale",key:"is_sale",align:"center",width:110,sorter:function(e,t){return e.is_sale===t.is_sale?0:e.is_sale?-1:1},filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:function(e,t){return t.is_sale===e},render:function(e,t){return g.a.createElement(s.a,{defaultChecked:e,title:"Is Sale",onChange:function(e){return function(e,t){I.j.mutate({mutation:I.k.UPDATE_PRODUCT,variables:{data:{prod_id:e.id,is_sale:t}},context:{headers:{TENANTID:"100001",Authorization:C.a.get("psp_t")}}}).then((function(t){var a,n=null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.updateProduct;if(!n.status)return U.b.error(n.message);U.b.success("".concat(e.prod_sku," status updated."))})).catch((function(e){return U.b.error("Something Went wrong !!")}))}(t,e)}})}},{title:"Date Added",dataIndex:"createdAt",key:"createdAt",width:120,align:"center",sorter:function(e,t){return e.createdAt===t.createdAt?0:e.createdAt?-1:1},render:function(e,t){return g.a.createElement("span",{className:"status-text"},g.a.createElement(M.a,{format:"DD-MMM-YYYY"},parseInt(e)))}},{title:"Date Updated",dataIndex:"updatedAt",key:"updatedAt",width:120,align:"center",sorter:function(e,t){return e.updatedAt===t.updatedAt?0:e.updatedAt?-1:1},render:function(e,t){return g.a.createElement("span",{className:"status-text"},g.a.createElement(M.a,{format:"DD-MMM-YYYY"},parseInt(e)))}},{title:"Action",dataIndex:"action",width:120,align:"center",render:function(e,t){return g.a.createElement(g.a.Fragment,null,g.a.createElement(S.b,{to:"/admin/products/view?id=".concat(t.id)},g.a.createElement(T.a,{name:"eye",style:{margin:".5em 1em",color:"rgb(46, 204, 113)"}})),g.a.createElement(S.b,{to:"/admin/products/edit?id=".concat(t.id)},g.a.createElement(T.a,{name:"edit",style:{margin:".5em 1em",color:"#5F63F2"}})))},key:"last_name"}],Ue=function(e,t){return[q()(e,"YYYY-MM-DD"),q()(t,"YYYY-MM-DD")]};return Object(f.useEffect)((function(){G&&(ke.availability.length>0||ke.categories.length>0||ke.condition.length>0||ke.attributes.length>0||""!==ke.searchQuery||""!==ke.endDate||""!==ke.startDate||""!==ke.updatedStartDate||""!==ke.updatedStartDate||""!==ke.minPrice||""!==ke.maxPrice||ke.productrep.length>0?_e(!1):_e(!0)),G=!0,I.j.query({query:I.e.GET_ALL_STAFF,context:{headers:{TENANTID:"100001",Authorization:C.a.get("psp_t")}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getAllStaff;xe(a)})).catch((function(e){xe((function(e){return Object(p.a)(Object(p.a)({},e),{},{error:"Something went Wrong.!! "})}))})).finally((function(){xe((function(e){return Object(p.a)(Object(p.a)({},e),{},{loading:!1})}))})),J&&we(!0),J=!1}),[ke]),g.a.createElement(g.a.Fragment,null,g.a.createElement(y.a,{title:"Products",buttons:[g.a.createElement("div",{key:"1",className:"page-header-actions"},g.a.createElement(_.a,{size:"small",type:"white",onClick:function(){return V((function(e){return!e}))}},g.a.createElement(E.a,{icon:"filter"}),"Filter"),g.a.createElement(_.a,{size:"small",type:"white",onClick:function(){ve(null),Ee(null),_e(!0),Ne({availability:[],categories:[],condition:[],attributes:[],productrep:[],startDate:"",endDate:"",minPrice:"",maxPrice:"",searchQuery:"",updatedEndDate:"",updatedStartDate:""})}},g.a.createElement(A.a,null),"Reset Filter"),g.a.createElement(S.b,{to:"/admin/products/add"},g.a.createElement(_.a,{size:"small",title:"Add Product",type:"primary"},g.a.createElement(E.a,{icon:"file-plus"}))))]}),g.a.createElement(O.b,null,g.a.createElement(c.a,{gutter:25},g.a.createElement(o.a,{sm:24,xs:24},g.a.createElement(j.a,{headless:!0},h.isLoading?g.a.createElement("div",{className:"spin"},g.a.createElement(d.a,null)):g.a.createElement(g.a.Fragment,null,g.a.createElement(c.a,{gutter:25},g.a.createElement(o.a,{span:15},g.a.createElement(u.a,{placeholder:"Search Products...",prefix:g.a.createElement(D.a,null),value:null===ke||void 0===ke?void 0:ke.searchQuery,onChange:function(e){e.persist();var t=e.target.value;Ne((function(e){return Object(p.a)(Object(p.a)({},e),{},{searchQuery:t})}))}})),g.a.createElement(o.a,{span:9},g.a.createElement(_.a,{size:"large",disabled:je,type:"primary",onClick:function(){var e,t,a,n,r,i,l;P((function(e){return Object(p.a)(Object(p.a)({},e),{},{isLoading:!0})})),I.j.query({query:I.l.GET_PRODUCT_LIST,variables:{query:{searchQuery:null!==(e=ke.searchQuery)&&void 0!==e?e:"",availability:ke.availability.length?ke.availability:null,attribute:ke.attributes.length?ke.attributes:null,category:ke.categories.length?ke.categories:null,condition:ke.condition.length?ke.condition:null,productRep:ke.productrep.length?ke.productrep:null,productEntryStartDate:null!==(t=ke.startDate)&&void 0!==t?t:"",productEntryEndDate:null!==(a=ke.endDate)&&void 0!==a?a:"",updatedStartDate:null!==(n=ke.updatedStartDate)&&void 0!==n?n:"",updatedEndDate:null!==(r=ke.updatedEndDate)&&void 0!==r?r:"",minPrice:null!==(i=parseFloat(ke.minPrice))&&void 0!==i?i:null,maxPrice:null!==(l=parseFloat(ke.maxPrice))&&void 0!==l?l:null}},context:{headers:{TENANTID:"100001",Authorization:C.a.get("psp_t")}},fetchPolicy:"cache-first"}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getProductList;(null===a||void 0===a?void 0:a.status)&&P(a)})).catch((function(e){P((function(e){return Object(p.a)(Object(p.a)({},e),{},{error:"Something went Wrong.!! "})}))})).finally((function(){P((function(e){return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1})})),Q(!F)}))}},"Search"))),g.a.createElement("br",null),g.a.createElement("br",null),K&&g.a.createElement("div",{style:{marginBottom:"2.5em"}},g.a.createElement(c.a,{gutter:16},g.a.createElement(o.a,{span:8},"Availability: ",g.a.createElement("br",null),g.a.createElement(l.a,{style:{width:"100%"},placeholder:"Select status",size:"middle",mode:"multiple",value:null===ke||void 0===ke?void 0:ke.availability,onDeselect:function(e){return Ne((function(t){return Object(p.a)(Object(p.a)({},t),{},{availability:t.availability.filter((function(t){return t!==e}))})}))},onSelect:function(e){Ne((function(t){return Object(p.a)(Object(p.a)({},t),{},{availability:ke.availability.concat(parseInt(e))})}))},options:le.data.map((function(e){return{label:e.name,value:e.id}}))})),g.a.createElement(o.a,{span:8},"Category: ",g.a.createElement("br",null),g.a.createElement(l.a,{style:{width:"100%"},placeholder:Z.isLoading?"Loading..":"Select category",size:"middle",mode:"multiple",optionFilterProp:"label",value:null===ke||void 0===ke?void 0:ke.categories,onDeselect:function(e){return Ne((function(t){return Object(p.a)(Object(p.a)({},t),{},{categories:t.categories.filter((function(t){return t!==e}))})}))},onSelect:function(e){Ne((function(t){return Object(p.a)(Object(p.a)({},t),{},{categories:ke.categories.concat(parseInt(e))})}))},options:Z.data.map((function(e){return{label:e.cat_name,value:e.id}}))})),g.a.createElement(o.a,{span:8},"Date Added: ",g.a.createElement("br",null),g.a.createElement(R,{style:{height:"40px",width:"100%"},size:"small",allowClear:!0,picker:"date",value:""!==be?be:"",onChange:function(e){e?(Ne((function(t){var a,n;return Object(p.a)(Object(p.a)({},t),{},{startDate:null!==(a=e[0]._d)&&void 0!==a?a:"",endDate:null!==(n=e[1]._d)&&void 0!==n?n:""})})),ve(Ue(e[0],e[1]))):ve(null)}}))),g.a.createElement(c.a,{gutter:16,style:{marginTop:".5em"}},g.a.createElement(o.a,{span:8},"Condition: ",g.a.createElement("br",null),g.a.createElement(l.a,{style:{width:"100%"},placeholder:"Select Condition",size:"middle",mode:"multiple",value:null===ke||void 0===ke?void 0:ke.condition,onDeselect:function(e){return Ne((function(t){return Object(p.a)(Object(p.a)({},t),{},{condition:t.condition.filter((function(t){return t!==e}))})}))},onSelect:function(e){Ne((function(t){return Object(p.a)(Object(p.a)({},t),{},{condition:ke.condition.concat(parseInt(e))})}))},options:de.data.map((function(e){return{label:e.name,value:e.id}}))})),g.a.createElement(o.a,{span:8},"Attributes: ",g.a.createElement("br",null),g.a.createElement(l.a,{style:{width:"100%"},placeholder:ae.isLoading?"Loading..":"Select Attribute",size:"middle",mode:"multiple",value:null===ke||void 0===ke?void 0:ke.attributes,onDeselect:function(e){return Ne((function(t){return Object(p.a)(Object(p.a)({},t),{},{attributes:t.attributes.filter((function(t){return t!==e}))})}))},onSelect:function(e){Ne((function(t){return Object(p.a)(Object(p.a)({},t),{},{attributes:ke.attributes.concat(parseInt(e))})}))},options:ae.data.map((function(e){return{label:e.attribute_name,value:e.id}}))})),g.a.createElement(o.a,{span:8},"Price: ",g.a.createElement("br",null),g.a.createElement(u.a.Group,{compact:!0,size:"default"},g.a.createElement(u.a,{type:"number",placeholder:"Min",style:{width:"50%",height:"40px"},value:null!==(e=null===ke||void 0===ke?void 0:ke.minPrice)&&void 0!==e?e:"",onChange:function(e){e.persist(),Ne((function(t){var a;return Object(p.a)(Object(p.a)({},t),{},{minPrice:null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.value})}))}}),g.a.createElement(u.a,{type:"number",placeholder:"Max",style:{width:"50%",height:"40px"},value:null!==(t=null===ke||void 0===ke?void 0:ke.maxPrice)&&void 0!==t?t:"",onChange:function(e){e.persist(),Ne((function(t){var a;return Object(p.a)(Object(p.a)({},t),{},{maxPrice:null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.value})}))}})))),Te&&g.a.createElement(c.a,{gutter:16,style:{marginTop:".5em"}},g.a.createElement(o.a,{span:8},"Product Rep: ",g.a.createElement("br",null),g.a.createElement(l.a,{style:{width:"100%"},size:"middle",mode:"multiple",value:null===ke||void 0===ke?void 0:ke.productrep,onDeselect:function(e){return Ne((function(t){return Object(p.a)(Object(p.a)({},t),{},{productrep:t.productrep.filter((function(t){return t!==e}))})}))},placeholder:Se.loading?"Loading...":"Select a Product Representative",options:null===Se||void 0===Se||null===(a=Se.data)||void 0===a?void 0:a.map((function(e){return{label:e.first_name+" "+e.last_name,value:e.id}})),onSelect:function(e){Ne((function(t){return Object(p.a)(Object(p.a)({},t),{},{productrep:ke.productrep.concat(parseInt(e))})}))}})),g.a.createElement(o.a,{span:8},"Date Updated: ",g.a.createElement("br",null),g.a.createElement(R,{style:{height:"40px",width:"100%"},size:"small",allowClear:!0,picker:"date",value:""!==he?he:"",onChange:function(e){e?(Ne((function(t){var a,n;return Object(p.a)(Object(p.a)({},t),{},{updatedStartDate:null!==(a=e[0]._d)&&void 0!==a?a:"",updatedEndDate:null!==(n=e[1]._d)&&void 0!==n?n:""})})),Ee(Ue(e[0],e[1]))):Ee(null)}})),g.a.createElement(o.a,{span:8},"Quantity: ",g.a.createElement("br",null),g.a.createElement(u.a.Group,{compact:!0,size:"default"},g.a.createElement(u.a,{type:"number",placeholder:"Min Amount",style:{width:"50%",height:"40px"}}),g.a.createElement(u.a,{type:"number",placeholder:"Max Amount",style:{width:"50%",height:"40px"}}))))),g.a.createElement("span",{className:"psp_list"},g.a.createElement(i.a,{className:"table-responsive",columns:Te?ze:ze.filter((function(e){return"updatedAt"!==e.dataIndex})),rowKey:"id",size:"small",dataSource:h.data?h.data:[],rowClassName:function(e,t){return t%2==0?"":"altTableClass"},pagination:{defaultPageSize:L.a.PRODUCTS_PER_PAGE,total:h.data?h.data.length:0,showTotal:function(e,t){return"".concat(t[0],"-").concat(t[1]," of ").concat(e," items")}}}))))))))}}}]);
//# sourceMappingURL=67.5dee9e83.chunk.js.map