(this.webpackJsonpprime_server_parts=this.webpackJsonpprime_server_parts||[]).push([[69],{1019:function(e,t,a){"use strict";a.r(t);a(304);var n=a(214),s=(a(196),a(95)),i=(a(197),a(72)),r=(a(145),a(44)),o=(a(162),a(96)),l=a(9),c=(a(278),a(50)),m=a(23),u=a(0),d=a.n(u),p=a(213),E=a(161),f=a(160),g=a(212),h=a(56),_=a(12),b=a(69),v=a(68),S=a.n(v),N=a(45),O=a(305),y=a.n(O),I=a(22);t.default=function(){var e,t;Object(I.f)("permission");var a=Object(h.useLocation)().search,v=y.a.parse(a),O=Object(h.useHistory)(),P=c.a.useForm(),T=Object(m.a)(P,1)[0],A=Object(u.useState)(!0),R=Object(m.a)(A,2),j=R[0],L=R[1],x=Object(u.useState)(!1),z=Object(m.a)(x,2),q=z[0],w=z[1],C=Object(u.useState)({data:[],isLoading:!0}),D=Object(m.a)(C,2),M=D[0],F=D[1];Object(u.useEffect)((function(){v.id&&b.j.query({query:b.e.GET_SINGLE_ROLES_PERMISSION,variables:{query:{id:parseInt(v.id)}},context:{headers:{TENANTID:"100001",Authorization:S.a.get("psp_t")}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getSingleRolesPermission;F({data:a.data,isLoading:!1}),L(a.data.roles_permission_status)})).catch((function(e){console.log(e)}))}),[]);return d.a.createElement(d.a.Fragment,null,d.a.createElement(p.a,{title:v.id?"Manage Permission | Edit Permission ".concat(M.isLoading?"":"(".concat(M.data.roles_permission_name,")")):"Add Permission"}),d.a.createElement(E.b,null,d.a.createElement(s.a,{gutter:25},d.a.createElement(i.a,{sm:24,xs:24},d.a.createElement(f.a,{headless:!0},v.id&&M.isLoading?d.a.createElement("div",{style:{textAlign:"center"}},d.a.createElement(o.a,{tip:"processing..."})):d.a.createElement(c.a,{style:{width:"100%"},form:T,name:"addRole",onFinish:function(e){if(console.log(e),w(!0),v.id){var t={data:{id:parseInt(v.id),roles_permission_name:e.permissionName,roles_permission_status:j}};b.j.mutate({mutation:b.d.UPDATE_ROLES_PERMISSION,variables:t,context:{headers:{TENANTID:"100001",Authorization:S.a.get("psp_t")}},refetchQueries:[{query:b.e.GET_ALL_ROLES_PERMISSION,context:{headers:{TENANTID:"100001",Authorization:S.a.get("psp_t")}}},["getAllRolesPermission"]]}).then((function(t){var a,n=null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.updateRolesPermission;if(!n.status)return N.b.error(n.message);setTimeout((function(){O.push("/admin/permission/list")}),1e3),N.b.success("".concat(e.permissionName," updated successfully"))})).catch((function(e){return console.log("got error on update Permission",e),N.b.error("Soemthing Went wrong !!")})).finally((function(){w(!1)}))}else b.j.mutate({mutation:b.d.CREATE_ROLES_PERMISSION,variables:{data:Object(l.a)(Object(l.a)({},e),{},{permissionStatus:j})},context:{headers:{TENANTID:"100001",Authorization:S.a.get("psp_t")}},refetchQueries:[{query:b.e.GET_ALL_ROLES_PERMISSION,context:{headers:{TENANTID:"100001",Authorization:S.a.get("psp_t")}}},["getAllRolesPermission"]]}).then((function(t){var a,n=null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.createRolesPermission;if(!n.status)return N.b.error(n.message);setTimeout((function(){O.push("/admin/permission/list")}),1e3),N.b.success("".concat(e.permissionName," added successfully"))})).catch((function(e){return console.log("got error on addPermission",e),N.b.error("Soemthing Went wrong !!")})).finally((function(){w(!1)}))},onFinishFailed:function(e){return console.log("form error info:\n",e)},labelCol:{span:4}},d.a.createElement(s.a,{gutter:25},d.a.createElement(i.a,{span:10},d.a.createElement(c.a.Item,{rules:[{required:!0,max:30,message:"Please enter Role Name"}],name:"permissionName",label:"Name",initialValue:null===M||void 0===M||null===(e=M.data)||void 0===e?void 0:e.roles_permission_name,labelCol:{style:{width:"40%"}}},d.a.createElement(s.a,null,d.a.createElement(i.a,{span:22},d.a.createElement(r.a,{defaultValue:null===M||void 0===M||null===(t=M.data)||void 0===t?void 0:t.roles_permission_name,placeholder:"Enter Permission Name"})))))),d.a.createElement(c.a.Item,{name:"permissionStatus",label:"Status"},d.a.createElement(n.a,{checked:j,onChange:function(e){return L(e)}})),d.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"3em"}},d.a.createElement(c.a.Item,null,d.a.createElement(g.a,{loading:q,size:"default",htmlType:"submit",type:"primary",raised:!0},q?"Processing":"Save"),d.a.createElement(_.b,{to:"/admin/permission/list"},d.a.createElement(g.a,{style:{marginLeft:10},type:"light",size:"default"},"Cancel"))))))))))}}}]);