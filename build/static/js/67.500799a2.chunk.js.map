{"version":3,"sources":["container/products/ListCoupon.js"],"names":["ListCoupon","viewPermission","useState","Array","keys","map","i","n","c","t","aa","mia","maa","sd","ed","status","d","so","data","isLoading","coupons","setCoupons","filteredCoupons","setFilteredCoupons","searchText","setSearchText","useEffect","apolloClient","query","couponQuery","GET_ALL_COUPONS","context","headers","TENANTID","process","Authorization","Cookies","get","then","res","getAllCoupons","s","error","catch","err","finally","columns","title","dataIndex","key","sorter","a","b","coupon_name","toUpperCase","coupon_code","coupon_type","align","coupon_amount","coupon_minamount","coupon_maxamount","coupon_startdate","render","value","record","Date","parseInt","toLocaleDateString","coupon_enddate","coupon_sortorder","coupon_status","filters","text","onFilter","attrgroup_status","defaultChecked","onChange","checked","handleStatusChange","width","to","name","style","margin","variables","coupon_id","id","console","log","mutate","mutation","couponMutation","UPDATE_COUPON","updateCoupon","toast","message","success","buttons","className","size","type","icon","gutter","sm","xs","headless","placeholder","prefix","e","target","filter","coupon","coupon_description","toLowerCase","includes","scroll","x","rowKey","dataSource","rowClassName","index","pagination","defaultPageSize","config","COUPON_GROUPS_PER_PAGE","total","length","showTotal","range"],"mappings":"yZAoReA,UApQI,WACfC,YAAe,UACf,MAAkCC,oBAAS,GAAM,mBAejD,GAfgB,KAAc,KACZ,YAAIC,MAAM,IAAIC,QAAQC,KAAI,SAAAC,GAAC,MAAK,CAC9CC,EAAE,SAAD,OAAWD,EAAI,GAChBE,EAAGF,EAAI,EACPG,EAAG,MACHC,GAAI,IACJC,IAAK,IACLC,IAAK,IACLC,GAAI,cACJC,GAAI,cACJC,QAAQ,EACRC,EAAG,8JACHC,GAAIX,EAAI,MAGkBJ,mBAAS,CAAEgB,KAAM,GAAIC,WAAW,KAAO,mBAA9DC,EAAO,KAAEC,EAAU,KAC1B,EAA8CnB,mBAAS,IAAG,mBAAnDoB,EAAe,KAAEC,EAAkB,KAC1C,EAAoCrB,mBAAS,IAAG,mBAAzCsB,EAAU,KAAEC,EAAa,KAEhCC,qBAAU,WACNC,IAAaC,MAAM,CACfA,MAAOC,IAAYC,gBACnBC,QAAS,CACLC,QAAS,CACLC,SAAUC,SACVC,cAAeC,IAAQC,IAAI,aAGpCC,MAAK,SAAAC,GAAQ,IAAD,EAELrB,EAAU,OAAHqB,QAAG,IAAHA,GAAS,QAAN,EAAHA,EAAKrB,YAAI,WAAN,EAAH,EAAWsB,eAEf,OAAJtB,QAAI,IAAJA,OAAI,EAAJA,EAAMH,SACXM,GAAW,SAAAoB,GAAC,kCAAUA,GAAC,IAAEvB,KAAU,OAAJA,QAAI,IAAJA,OAAI,EAAJA,EAAMA,KAAMwB,MAAO,WAEnDC,OAAM,SAAAC,GACLvB,GAAW,SAAAoB,GAAC,kCAAUA,GAAC,IAAEC,MAAO,mCACjCG,SAAQ,WACPxB,GAAW,SAAAoB,GAAC,kCAAUA,GAAC,IAAEtB,WAAW,YAGzC,IAGH,IAAM2B,EAAU,CACZ,CACIC,MAAO,OACPC,UAAW,cACXC,IAAK,cACLC,OAAQ,SAACC,EAAGC,GAAC,OAAKD,EAAEE,YAAYC,cAAgBF,EAAEC,YAAYC,cAAgB,GAAK,IAEvF,CACIP,MAAO,OACPC,UAAW,cACXC,IAAK,cACLC,OAAQ,SAACC,EAAGC,GAAC,OAAKD,EAAEI,YAAYD,cAAgBF,EAAEG,YAAYD,cAAgB,GAAK,IAEvF,CACIP,MAAO,OACPC,UAAW,cACXC,IAAK,cACLC,OAAQ,SAACC,EAAGC,GAAC,OAAKD,EAAEK,YAAYF,cAAgBF,EAAEI,YAAYF,cAAgB,GAAK,IAWvF,CACIP,MAAO,SACPC,UAAW,gBACXC,IAAK,gBACLQ,MAAO,SACPP,OAAQ,SAACC,EAAGC,GAAC,OAAMD,EAAEO,gBAAkBN,EAAEM,cAAiB,EAAIP,EAAEO,eAAiB,EAAI,IAEzF,CACIX,MAAO,aACPC,UAAW,mBACXC,IAAK,mBACLQ,MAAO,SACPP,OAAQ,SAACC,EAAGC,GAAC,OAAMD,EAAEQ,mBAAqBP,EAAEO,iBAAoB,EAAIR,EAAEQ,kBAAoB,EAAI,IAElG,CACIZ,MAAO,aACPC,UAAW,mBACXC,IAAK,mBACLQ,MAAO,SACPP,OAAQ,SAACC,EAAGC,GAAC,OAAMD,EAAES,mBAAqBR,EAAEQ,iBAAoB,EAAIT,EAAES,kBAAoB,EAAI,IAElG,CACIb,MAAO,aACPC,UAAW,mBACXC,IAAK,mBACLC,OAAQ,SAACC,EAAGC,GAAC,OAAMD,EAAEU,mBAAqBT,EAAES,iBAAoB,EAAIV,EAAEU,kBAAoB,EAAI,GAC9FC,OAAQ,SAACC,EAAOC,GAAM,OAAK,IAAIC,KAAKC,SAASH,IAAQI,uBAEzD,CACIpB,MAAO,WACPC,UAAW,iBACXC,IAAK,iBACLC,OAAQ,SAACC,EAAGC,GAAC,OAAMD,EAAEiB,iBAAmBhB,EAAEgB,eAAkB,EAAIjB,EAAEiB,gBAAkB,EAAI,GACxFN,OAAQ,SAACC,EAAOC,GAAM,OAAK,IAAIC,KAAKC,SAASH,IAAQI,uBASzD,CACIpB,MAAO,aACPC,UAAW,mBACXC,IAAK,mBACLQ,MAAO,SACPP,OAAQ,SAACC,EAAGC,GAAC,OAAMD,EAAEkB,mBAAqBjB,EAAEiB,iBAAoB,EAAIlB,EAAEkB,kBAAoB,EAAI,IAElG,CACItB,MAAO,SACPC,UAAW,gBACXC,IAAK,gBACLQ,MAAO,SACPP,OAAQ,SAACC,EAAGC,GAAC,OAAMD,EAAEmB,gBAAkBlB,EAAEkB,cAAiB,EAAInB,EAAEmB,eAAiB,EAAI,GACrFC,QAAS,CACL,CACIC,KAAM,SACNT,OAAO,GAEX,CACIS,KAAM,WACNT,OAAO,IAGfU,SAAU,SAACV,EAAOC,GAAM,OAAKA,EAAOU,mBAAqBX,GACzDD,OAAQ,SAACC,EAAOC,GAAM,OAClB,uBACIW,eAAgBZ,EAAOhB,MAAM,SAC7B6B,SAAU,SAAAC,GAAO,OAAIC,EAAmBd,EAAQa,QAK5D,CACI9B,MAAO,SACPC,UAAW,KACXC,IAAK,KACL8B,MAAO,GACPtB,MAAO,QACPK,OAAQ,SAACC,EAAOC,GAAM,OAClB,oCACI,kBAAC,IAAI,CAACgB,GAAE,wCAAmCjB,IAEvC,kBAAC,IAAW,CAACkB,KAAK,OAAOC,MAAO,CAAEC,OAAQ,mBAcxDL,EAAqB,SAACd,EAAQa,GAChC,IAAMO,EAAY,CAAElE,KAAM,CAAEmE,UAAWrB,EAAOsB,GAAIhB,cAAeO,IACjEU,QAAQC,IAAIJ,GAEZzD,IAAa8D,OAAO,CAChBC,SAAUC,IAAeC,cACzBR,YACArD,QAAS,CACLC,QAAS,CACLC,SAAUC,SACVC,cAAeC,IAAQC,IAAI,aAIpCC,MAAK,SAAAC,GAAQ,IAAD,EACLrB,EAAU,OAAHqB,QAAG,IAAHA,GAAS,QAAN,EAAHA,EAAKrB,YAAI,WAAN,EAAH,EAAW2E,aACxB,IAAK3E,EAAKH,OAAQ,OAAO+E,IAAMpD,MAAMxB,EAAK6E,SAC1CD,IAAME,QAAQ,GAAD,OAAIhC,EAAOX,YAAW,oCAEpCV,OAAM,SAAAC,GAEL,OADA2C,QAAQC,IAAI,6BAA8B5C,GACnCkD,IAAMpD,MAAM,+BAM3B,OACI,oCACI,kBAAC,IAAU,CACPK,MAAM,UACNkD,QAAS,CACL,yBAAKhD,IAAI,IAAIiD,UAAU,uBACnB,kBAAC,IAAI,CAAClB,GAAG,8BACL,kBAAC,IAAM,CAACmB,KAAK,QAAQpD,MAAM,cAAcqD,KAAK,WAC1C,kBAAC,IAAW,CAACC,KAAK,oBAMtC,kBAAC,IAAI,KACD,uBAAKC,OAAQ,IACT,uBAAKC,GAAI,GAAIC,GAAI,IACb,kBAAC,IAAK,CAACC,UAAQ,GACVrF,EAAQD,UACL,yBAAK+E,UAAU,QACX,6BAGJ,oCACI,uBAAOQ,YAAY,oBAAoBC,OAAQ,kBAAC,IAAc,MAAK/B,SAzD5E,SAAAgC,GACnB,IAAM7C,EAAQ6C,EAAEC,OAAO9C,MACvBtC,EAAcsC,GACdxC,EAAmBH,EAAQF,KAAK4F,QAAO,SAAAC,GAAM,QAAW,OAANA,QAAM,IAANA,OAAM,EAANA,EAAQ1D,aAAc0D,EAAOC,mBAAqBD,EAAOxD,aAAa0D,cAAcC,SAASnD,EAAMkD,sBAuDzH,6BAAM,6BAEN,0BAAMf,UAAW,YACb,uBACIiB,OAAQ,CAAEC,EAAG,eACblB,UAAU,mBACVC,KAAK,QACLrD,QAASA,EACTuE,OAAQ,KACRC,WAAY9F,EAAaF,EAAkBF,EAAQF,KACnDqG,aAAc,SAACvD,EAAQwD,GAAK,OAAMA,EAAQ,IAAM,EAAI,GAAK,iBAEzDC,WAAY,CACRC,gBAAiBC,IAAOC,uBACxBC,MAAOrG,EAAaF,EAAgBwG,OAAS1G,EAAQF,KAAK4G,OAC1DC,UAAW,SAACF,EAAOG,GAAK,gBAAQA,EAAM,GAAE,YAAIA,EAAM,GAAE,eAAOH,EAAK","file":"static/js/67.500799a2.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Row, Col, Input, Table, Spin, Switch } from 'antd';\nimport FeatherIcon from 'feather-icons-react';\nimport { SearchOutlined } from '@ant-design/icons';\nimport { PageHeader } from '../../components/page-headers/page-headers';\nimport { Main } from '../styled';\nimport { Cards } from '../../components/cards/frame/cards-frame';\nimport { Button } from '../../components/buttons/buttons';\nimport { Link } from 'react-router-dom';\nimport FontAwesome from 'react-fontawesome';\nimport apolloClient, { couponMutation, couponQuery } from '../../utility/apollo';\nimport Cookies from 'js-cookie';\nimport { toast } from 'react-toastify';\nimport config from '../../config/config';\nimport { viewPermission } from '../../utility/utility';\n\nconst ListCoupon = () => {\n    viewPermission('coupon');\n    const [isLoading, setIsLoading] = useState(false)\n    const dummyData = [...Array(10).keys()].map(i => ({\n        n: `Coupon${i + 1}`,\n        c: i + 1,\n        t: 'aaa',\n        aa: 102,\n        mia: 100,\n        maa: 1000,\n        sd: \"18 oct 2022\",\n        ed: '18 oct 2022',\n        status: true,\n        d: \"Lorem ipsum, dolor sit amet consectetur adipisicing elit. Atque, architecto quod quidem fuga assumenda temporibus quam quae sapiente cupiditate voluptatum.\",\n        so: i + 1\n    }))\n    // const [attributeGroups, setAttributeGroups] = useState({ data: dummyData, isLoading: false })\n    const [coupons, setCoupons] = useState({ data: [], isLoading: true })\n    const [filteredCoupons, setFilteredCoupons] = useState([])\n    const [searchText, setSearchText] = useState('')\n\n    useEffect(() => {\n        apolloClient.query({\n            query: couponQuery.GET_ALL_COUPONS,\n            context: {\n                headers: {\n                    TENANTID: process.env.REACT_APP_TENANTID,\n                    Authorization: Cookies.get('psp_t')\n                }\n            }\n        }).then(res => {\n\n            const data = res?.data?.getAllCoupons\n\n            if (!data?.status) return\n            setCoupons(s => ({ ...s, data: data?.data, error: '' }))\n\n        }).catch(err => {\n            setCoupons(s => ({ ...s, error: 'Something went Wrong.!! ' }))\n        }).finally(() => {\n            setCoupons(s => ({ ...s, isLoading: false }))\n        })\n\n    }, []);\n\n\n    const columns = [\n        {\n            title: 'Name',\n            dataIndex: 'coupon_name',\n            key: 'coupon_name',\n            sorter: (a, b) => a.coupon_name.toUpperCase() > b.coupon_name.toUpperCase() ? 1 : -1,\n        },\n        {\n            title: 'CODE',\n            dataIndex: 'coupon_code',\n            key: 'coupon_code',\n            sorter: (a, b) => a.coupon_code.toUpperCase() > b.coupon_code.toUpperCase() ? 1 : -1,\n        },\n        {\n            title: 'Type',\n            dataIndex: 'coupon_type',\n            key: 'coupon_type',\n            sorter: (a, b) => a.coupon_type.toUpperCase() > b.coupon_type.toUpperCase() ? 1 : -1,\n        },\n        // {\n        //     title: 'Description',\n        //     dataIndex: 'd',\n        //     key: 'd',\n        //     width: 10,\n        //     ellipsis: true,\n        //     render: (value, record) => <p>{value}</p>,\n        //     sorter: (a, b) => a.d.toUpperCase() > b.d.toUpperCase() ? 1 : -1,\n        // },\n        {\n            title: 'Amount',\n            dataIndex: 'coupon_amount',\n            key: 'coupon_amount',\n            align: \"center\",\n            sorter: (a, b) => (a.coupon_amount === b.coupon_amount) ? 0 : a.coupon_amount ? -1 : 1,\n        },\n        {\n            title: \"Min Amount\",\n            dataIndex: 'coupon_minamount',\n            key: 'coupon_minamount',\n            align: \"center\",\n            sorter: (a, b) => (a.coupon_minamount === b.coupon_minamount) ? 0 : a.coupon_minamount ? -1 : 1,\n        },\n        {\n            title: \"Max Amount\",\n            dataIndex: 'coupon_maxamount',\n            key: 'coupon_maxamount',\n            align: \"center\",\n            sorter: (a, b) => (a.coupon_maxamount === b.coupon_maxamount) ? 0 : a.coupon_maxamount ? -1 : 1,\n        },\n        {\n            title: 'Start Date',\n            dataIndex: 'coupon_startdate',\n            key: 'coupon_startdate',\n            sorter: (a, b) => (a.coupon_startdate === b.coupon_startdate) ? 0 : a.coupon_startdate ? -1 : 1,\n            render: (value, record) => new Date(parseInt(value)).toLocaleDateString()\n        },\n        {\n            title: 'End Date',\n            dataIndex: 'coupon_enddate',\n            key: 'coupon_enddate',\n            sorter: (a, b) => (a.coupon_enddate === b.coupon_enddate) ? 0 : a.coupon_enddate ? -1 : 1,\n            render: (value, record) => new Date(parseInt(value)).toLocaleDateString()\n        },\n\n        // {\n        //     title: 'Name',\n        //     dataIndex: 'n',\n        //     key: 'n',\n        //     sorter: (a, b) => a.n.toUpperCase() > b.n.toUpperCase() ? 1 : -1,\n        // },\n        {\n            title: 'Sort Order',\n            dataIndex: 'coupon_sortorder',\n            key: 'coupon_sortorder',\n            align: 'center',\n            sorter: (a, b) => (a.coupon_sortorder === b.coupon_sortorder) ? 0 : a.coupon_sortorder ? -1 : 1,\n        },\n        {\n            title: 'Status',\n            dataIndex: 'coupon_status',\n            key: 'coupon_status',\n            align: 'center',\n            sorter: (a, b) => (a.coupon_status === b.coupon_status) ? 0 : a.coupon_status ? -1 : 1,\n            filters: [\n                {\n                    text: 'Active',\n                    value: true,\n                },\n                {\n                    text: 'Inactive',\n                    value: false,\n                }\n            ],\n            onFilter: (value, record) => record.attrgroup_status === value,\n            render: (value, record) => (\n                <Switch\n                    defaultChecked={value} title='Status'\n                    onChange={checked => handleStatusChange(record, checked)}\n                />\n            )\n        },\n\n        {\n            title: 'Action',\n            dataIndex: 'id',\n            key: 'id',\n            width: 70,\n            align: 'right',\n            render: (value, record) => (\n                <>\n                    <Link to={`/admin/products/add-coupon?id=${value}`}>\n                        {/* <Button size=\"default\" type=\"white\" title='Edit'> */}\n                        <FontAwesome name=\"edit\" style={{ margin: \".5em 1em\" }} />\n                        {/* </Button> */}\n                    </Link>\n                </>\n            ),\n        },\n    ]\n\n    const onChangeSearch = e => {\n        const value = e.target.value\n        setSearchText(value)\n        setFilteredCoupons(coupons.data.filter(coupon => (coupon?.coupon_name + coupon.coupon_description + coupon.coupon_code).toLowerCase().includes(value.toLowerCase())))\n    }\n\n    const handleStatusChange = (record, checked) => {\n        const variables = { data: { coupon_id: record.id, coupon_status: checked } }\n        console.log(variables)\n        // return;\n        apolloClient.mutate({\n            mutation: couponMutation.UPDATE_COUPON,\n            variables,\n            context: {\n                headers: {\n                    TENANTID: process.env.REACT_APP_TENANTID,\n                    Authorization: Cookies.get('psp_t')\n                },\n            },\n\n        }).then(res => {\n            const data = res?.data?.updateCoupon\n            if (!data.status) return toast.error(data.message);\n            toast.success(`${record.coupon_name} status updated successfully`);\n\n        }).catch(err => {\n            console.log(\"got error on status update\", err)\n            return toast.error('Something Went wrong !!')\n        })\n\n    }\n\n\n    return (\n        <>\n            <PageHeader\n                title=\"Coupons\"\n                buttons={[\n                    <div key=\"1\" className=\"page-header-actions\">\n                        <Link to=\"/admin/products/add-coupon\">\n                            <Button size=\"small\" title=\"Add Coupons\" type=\"primary\">\n                                <FeatherIcon icon=\"file-plus\" />\n                            </Button>\n                        </Link>\n                    </div>\n                ]}\n            />\n            <Main>\n                <Row gutter={25}>\n                    <Col sm={24} xs={24}>\n                        <Cards headless>\n                            {coupons.isLoading ?\n                                <div className=\"spin\">\n                                    <Spin />\n                                </div>\n                                :\n                                <>\n                                    <Input placeholder=\"Search Coupons...\" prefix={<SearchOutlined />} onChange={onChangeSearch} />\n                                    <br /><br />\n\n                                    <span className={\"psp_list\"} >\n                                        <Table\n                                            scroll={{ x: \"max-content\" }}\n                                            className=\"table-responsive\"\n                                            size=\"small\"\n                                            columns={columns}\n                                            rowKey={'id'}\n                                            dataSource={searchText ? filteredCoupons : coupons.data}\n                                            rowClassName={(record, index) => (index % 2 === 0 ? \"\" : \"altTableClass\")}\n                                            // pagination={false}\n                                            pagination={{\n                                                defaultPageSize: config.COUPON_GROUPS_PER_PAGE,\n                                                total: searchText ? filteredCoupons.length : coupons.data.length,\n                                                showTotal: (total, range) => `${range[0]}-${range[1]} of ${total} items`,\n                                            }}\n                                        />\n                                    </span>\n\n\n\n                                </>\n\n                            }\n\n\n\n                        </Cards>\n                    </Col>\n                </Row>\n            </Main>\n        </>\n    );\n};\n\nexport default ListCoupon;\n"],"sourceRoot":""}