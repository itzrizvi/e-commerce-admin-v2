(this.webpackJsonpprime_server_parts=this.webpackJsonpprime_server_parts||[]).push([[50],{1002:function(e,a,t){"use strict";t.r(a);t(94);var n=t(36),l=(t(175),t(108)),r=(t(78),t(20)),i=(t(79),t(15)),s=(t(93),t(24)),o=(t(139),t(89)),c=(t(243),t(120)),u=t(6),d=(t(113),t(16)),m=t(9),E=(t(310),t(50)),f=t(0),p=t.n(f),g=t(25),h=t.n(g),b=t(138),v=t(107),_=t(106),y=t(68),j=t(74),O=t(13),N=t(43),A=t(29),S=t(32),T=t(242),L=t.n(T),x=t(90),I=t.n(x),w=t(26),P=t(60);E.a.Paragraph;a.default=function(){var e,a,t,E;Object(w.d)("user");var g=Object(j.useHistory)(),T=Object(j.useLocation)().search,x=L.a.parse(T),F=Object(f.useState)(!0),C=Object(m.a)(F,2),D=C[0],z=C[1],R=Object(f.useState)([]),q=Object(m.a)(R,2),k=q[0],G=q[1],U=Object(f.useState)(!0),V=Object(m.a)(U,2),M=V[0],W=(V[1],Object(f.useState)({data:{},isLoading:!0})),J=Object(m.a)(W,2),Q=J[0],H=J[1],K=Object(f.useState)({roles:[],isLoading:!0,error:null}),B=Object(m.a)(K,2),X=B[0],Y=B[1],Z=Object(f.useState)(!1),$=Object(m.a)(Z,2),ee=$[0],ae=$[1],te=Object(f.useState)(!1),ne=Object(m.a)(te,2),le=ne[0],re=ne[1],ie=Object(N.d)((function(e){return e.auth.token})),se=Object(f.useState)({data:[],isLoading:!0}),oe=Object(m.a)(se,2),ce=oe[0],ue=oe[1],de=d.a.useForm(),me=Object(m.a)(de,1)[0];Object(f.useEffect)((function(){Y((function(e){return Object(u.a)(Object(u.a)({},e),{},{isLoading:!0})})),A.j.query({query:A.e.GET_ALL_ROLES,context:{headers:{TENANTID:"100001",Authorization:ie}}}).then((function(e){var a,t=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.getAllRoles;t.status&&Y((function(e){return Object(u.a)(Object(u.a)({},e),{},{roles:t.data})}))})).catch((function(e){console.log("Error on get all role",e)})).finally((function(){Y((function(e){return Object(u.a)(Object(u.a)({},e),{},{isLoading:!1})}))}))}),[]),Object(f.useEffect)((function(){x.id&&A.j.query({query:A.e.GET_SINGLE_ADMIN,variables:{query:{id:parseInt(x.id)}},context:{headers:{TENANTID:"100001",Authorization:ie}}}).then((function(e){var a,t=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.getSingleAdmin;if(t.status){var n;H({data:t.data,isLoading:!1});var l=(null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.roles).map((function(e){return e.id}));ue({data:l,isLoading:!1}),G(l)}})).catch((function(e){console.log("Error on loading single user",e)})).finally((function(){Y((function(e){return Object(u.a)(Object(u.a)({},e),{},{isLoading:!1})}))}))}),[]);var Ee=[{title:"Role",dataIndex:"role",key:"role",width:100,ellipsis:!0,render:function(e,a){return p.a.createElement(c.a,{value:a.id},a.role)},sorter:function(e,a){return e.role>a.role?1:-1}},{title:"Role Descrption",dataIndex:"role_description",key:"role_description",width:120,render:function(e){return e}}];return p.a.createElement(p.a.Fragment,null,p.a.createElement(b.a,{title:x.id?"Manage User | Edit user ".concat(Q.isLoading?"":"(".concat(Q.data.email,")")):"Add Admin",buttons:[x.id&&p.a.createElement("div",{key:"1",className:"page-header-actions"},p.a.createElement(y.a,{disabled:Q.isLoading,loading:le,onClick:function(){re(!0),A.j.mutate({mutation:A.e.SEND_RESET_PASSWORD,variables:{data:{email:Q.data.email,permissionName:"user"}},context:{headers:{TENANTID:"100001",Authorization:ie}}}).then((function(e){var a,t=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.resetPassword;t.status?S.b.success(t.message):S.b.error(t.message)})).catch((function(e){S.b.error("Something Went wrong !!")})).finally((function(){return re(!1)}))},size:"small",title:"Reset Password",type:"primary"},p.a.createElement(h.a,{icon:"settings"}),ee?"Processing":"Reset Password"))]}),p.a.createElement(v.b,null,p.a.createElement(r.a,{gutter:25},p.a.createElement(i.a,{sm:24,xs:24},p.a.createElement(_.a,{headless:!0},x.id&&Q.isLoading?p.a.createElement("div",{div:!0,className:"spin"},p.a.createElement(o.a,null)):p.a.createElement(d.a,{style:{width:"100%"},form:me,name:"addAdmin",onFinish:function(e){if(!k.length)return S.b.warn("Select At List 1 Role..");if(ae(!0),x.id){var a=e.first_name,t=e.last_name,n=e.phone,l=e.fax,r={data:{id:parseInt(x.id),first_name:a,phone:n,fax:l,last_name:t,role_ids:k.map((function(e){return{role_id:e}})),user_status:D,sendEmail:M}};A.j.mutate({mutation:A.d.ADMIN_UPDATE,variables:r,refetchQueries:[{query:A.e.GET_ALL_STAFF,context:{headers:{TENANTID:"100001",Authorization:I.a.get("psp_t")}}},["getAllStaff"]],context:{headers:{TENANTID:"100001",Authorization:I.a.get("psp_t")}}}).then((function(e){var a,t=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.adminUpdate;if(!t.status)return S.b.error(t.message);setTimeout((function(){g.push("/admin/admin/admins")}),1e3),S.b.success(t.message)})).catch((function(e){console.log("Error on update admin",e),S.b.error("Something went wrong!!")})).finally((function(){return ae(!1)}))}else{var i={data:Object(u.a)(Object(u.a)({},e),{},{role_ids:k.map((function(e){return{role_id:e}})),userStatus:D,sendEmail:!0})};A.j.mutate({mutation:A.d.ADMIN_SIGN_UP,variables:i,refetchQueries:[{query:A.e.GET_ALL_STAFF,context:{headers:{TENANTID:"100001",Authorization:I.a.get("psp_t")}}},["getAllStaff"]],context:{headers:{TENANTID:"100001",Authorization:I.a.get("psp_t")}}}).then((function(a){var t=a.data.adminSignUp;if(!t.status)return S.b.error(t.message);setTimeout((function(){g.push("/admin/admin/admins")}),1e3),S.b.success("".concat(e.email," added successfully."))})).catch((function(e){console.log("Error on add admin",e),S.b.error("Something went wrong !!")})).finally((function(){return ae(!1)}))}},onFinishFailed:function(e){return console.log("form error info:\n",e)},labelCol:{span:4},initialValues:x.id?{first_name:Q.data.first_name,last_name:Q.data.last_name,phone:Q.data.phone,fax:Q.data.fax}:null},p.a.createElement(r.a,{gutter:25},p.a.createElement(i.a,{span:10},p.a.createElement(d.a.Item,{rules:[{required:!0,max:30,message:"Please enter First Name"}],name:"first_name",label:"First Name",labelCol:{style:{width:"40%"}}},p.a.createElement(r.a,null,p.a.createElement(i.a,{span:20},p.a.createElement(s.a,{defaultValue:null===Q||void 0===Q||null===(e=Q.data)||void 0===e?void 0:e.first_name,placeholder:"Enter First Name"})))))),p.a.createElement(r.a,{gutter:25},p.a.createElement(i.a,{span:10},p.a.createElement(d.a.Item,{rules:[{required:!0,message:"Please enter Last Name"}],name:"last_name",label:"Last Name",labelCol:{style:{width:"40%"}}},p.a.createElement(r.a,null,p.a.createElement(i.a,{span:20},p.a.createElement(s.a,{defaultValue:null===Q||void 0===Q||null===(a=Q.data)||void 0===a?void 0:a.last_name,placeholder:"Enter Last Name"})))))),!x.id&&p.a.createElement(r.a,{gutter:25},p.a.createElement(i.a,{span:10},p.a.createElement(d.a.Item,{rules:[{required:!0,message:"Please enter an email",max:30}],name:"email",label:"Email",labelCol:{style:{width:"40%"}}},p.a.createElement(r.a,null,p.a.createElement(i.a,{span:20},p.a.createElement(s.a,{type:"email",placeholder:"Enter Email Address"})))))),p.a.createElement(r.a,{gutter:25},p.a.createElement(i.a,{span:10},p.a.createElement(d.a.Item,{label:"Phone",name:"phone",labelCol:{style:{width:"40%"}}},p.a.createElement(r.a,null,p.a.createElement(i.a,{span:20},p.a.createElement(s.a,{type:"text",defaultValue:null===Q||void 0===Q||null===(t=Q.data)||void 0===t?void 0:t.phone,placeholder:"Enter Phone Number"})))))),p.a.createElement(r.a,{gutter:25},p.a.createElement(i.a,{span:10},p.a.createElement(d.a.Item,{label:"Fax",name:"fax",labelCol:{style:{width:"40%"}}},p.a.createElement(r.a,null,p.a.createElement(i.a,{span:20},p.a.createElement(s.a,{type:"text",defaultValue:null===Q||void 0===Q||null===(E=Q.data)||void 0===E?void 0:E.fax,placeholder:"Enter Fax Number"})))))),p.a.createElement(d.a.Item,{name:"userStatus",label:"User Status"},p.a.createElement(l.a,{checked:D,onChange:function(e){return z(e)}})),p.a.createElement(r.a,{gutter:25},p.a.createElement(i.a,{span:20,offset:2},p.a.createElement(d.a.Item,{name:"role_ids",initialValue:""},x.id&&ce.isLoading||X.isLoading?p.a.createElement("div",{className:"spin"},p.a.createElement(o.a,null)):p.a.createElement(p.a.Fragment,null,p.a.createElement(c.a.Group,{style:{width:"100%",marginTop:"1em"},defaultValue:ce.data,onChange:function(e){return G(e)}},p.a.createElement("span",{className:"psp_list"},p.a.createElement("h2",{style:{fontSize:"15px",fontWeight:"600"}},"Select Roles:"),p.a.createElement(n.a,{className:"table-responsive",columns:Ee,rowKey:"id",style:{borderRadius:"0px"},size:"small",dataSource:X.roles?X.roles:[],rowClassName:function(e,a){return a%2===0?"":"altTableClass"},pagination:{defaultPageSize:P.a.CUSTOMER_PER_PAGE,total:X.roles?X.roles.length:0,showTotal:function(e,a){return"".concat(a[0],"-").concat(a[1]," of ").concat(e," items")}}}))))))),p.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"3em"}},p.a.createElement(d.a.Item,null,p.a.createElement(y.a,{loading:ee,disabled:X.isLoading,size:"default",htmlType:"submit",type:"primary",raised:!0},ee?"Processing":"Save"),p.a.createElement(O.b,{to:"/admin/admin/admins"},p.a.createElement(y.a,{style:{marginLeft:10},type:"light",size:"default"},"Cancel"))))))))))}}}]);
//# sourceMappingURL=50.582e06ac.chunk.js.map