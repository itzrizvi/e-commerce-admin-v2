(this.webpackJsonpprime_server_parts=this.webpackJsonpprime_server_parts||[]).push([[31],{1016:function(e,t,a){"use strict";a.r(t);a(140);var n=a(65),r=(a(141),a(50)),d=(a(197),a(61)),s=(a(295),a(212)),i=(a(113),a(38)),u=a(81),l=a(58),o=a(7),c=(a(196),a(27)),m=a(14),f=a(0),p=a.n(f),b=a(118),g=a(99),y=a(97),E=a(98),v=a(57),h=a(12),O=a(45),j=a(28),A=a(33),_=a(23),C=a(616),S=(a(131),a(69)),I=(a(91),a(42)),T=(a(271),a(122)),D=(a(142),a(30)),x=a(19),N=a.n(x),k=a(165),R=function(e){var t=e.initialData,a=e.addresses,n=e.setAddresses,r=e.defaultAddressId,d=e.setDefaultAddressId,l=Object(f.useState)([]),c=Object(m.a)(l,2),b=c[0],g=c[1],y=Object(f.useState)({data:[],loading:!0}),E=Object(m.a)(y,2),v=E[0],h=E[1];Object(f.useEffect)((function(){j.j.query({query:k.a.GET_COUNTRY_LIST,context:{headers:{TENANTID:"100001"}}}).then((function(e){var t=e.data.getCountryList;if(!t.status)return!0;g(null===t||void 0===t?void 0:t.data)})),j.j.query({query:k.a.GET_STATE_LISTS,variables:{query:{code:""}},context:{headers:{TENANTID:"100001"}}}).then((function(e){var r,d=null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.getStateList;(null===d||void 0===d?void 0:d.status)&&(h({data:Object(o.a)(Object(o.a)({},t),{},{states:null===d||void 0===d?void 0:d.data}),loading:!1}),n(a.map((function(e){var t;return Object(o.a)(Object(o.a)({},e),{},{states:null===d||void 0===d||null===(t=d.data)||void 0===t?void 0:t.filter((function(t){return t.country_code===e.countryCode.code}))})}))))})).finally((function(){h((function(e){return Object(o.a)(Object(o.a)({},e),{},{loading:!1})}))}))}),[]);var O=[{title:"Country",dataIndex:["countryCode","name"],key:"name",render:function(e,t){var r;return p.a.createElement(D.a,{onSelect:function(e){n(a.map((function(a){return a.id===t.id?Object(o.a)(Object(o.a)({},a),{},{country:e,states:v.data.states.filter((function(t){return t.country_code===e}))}):a})))},style:{width:"100%"},placeholder:"Country",defaultValue:null===t||void 0===t||null===(r=t.countryCode)||void 0===r?void 0:r.code,options:null===b||void 0===b?void 0:b.map((function(e){return{label:null===e||void 0===e?void 0:e.name,value:null===e||void 0===e?void 0:e.code}}))})}},{title:"Address 1",dataIndex:"address1",key:"address1",width:400,render:function(e,t){return p.a.createElement(i.a,{defaultValue:e,type:"text",placeholder:"Address 1",onChange:function(e){return t.address1=e.target.value}})}},{title:"Address 2",dataIndex:"address2",key:"address2",width:400,render:function(e,t){return p.a.createElement(i.a,{defaultValue:e,type:"text",placeholder:"Address 2",onChange:function(e){return t.address2=e.target.value}})}},{title:"City",dataIndex:"city",key:"city",width:150,render:function(e,t){return p.a.createElement(i.a,{defaultValue:e,type:"text",placeholder:"City",onChange:function(e){return t.city=e.target.value}})}},{title:"State",dataIndex:"states",key:"states",width:150,render:function(e,t){return p.a.createElement(D.a,{style:{width:"100%"},placeholder:"State",options:null===e||void 0===e?void 0:e.map((function(e){return{label:e.state,value:e.abbreviation}})),onSelect:function(e){return t.state=e},defaultValue:t.state})}},{title:"Zip Code",dataIndex:"zip_code",key:"zip_code",width:150,render:function(e,t){return p.a.createElement(i.a,{defaultValue:e,type:"text",placeholder:"Zip Code",onChange:function(e){return t.zip_code=e.target.value}})}},{title:"Default",dataIndex:"id",key:"id",align:"right",width:70,render:function(e,t){return p.a.createElement(T.a,{checked:r===e,onChange:function(a){t.isDefault=a.target.checked,d(e)}})}},{title:"Status",dataIndex:"status",key:"status",align:"right",width:90,render:function(e,t){return p.a.createElement(s.a,{defaultChecked:e,title:"Status",onChange:function(e){return t.status=e}})}},{title:"Action",dataIndex:"action",key:"action",width:150,render:function(e,t){return p.a.createElement(I.a,{size:"",title:"Remove",type:"danger",onClick:function(){return A(t.id)}},p.a.createElement(N.a,{icon:"trash-2"}))}}],A=function(e){n((function(t){return t.filter((function(t){return t.id!==e}))}))};return p.a.createElement("div",null,p.a.createElement(S.a,{className:"table-responsive",columns:O,rowClassName:function(e,t){return t%2===0?"":"altTableClass"},pagination:!1,rowKey:"id",size:"small",dataSource:a,loading:null===v||void 0===v?void 0:v.loading}),p.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"10px",marginBottom:"10px"}},p.a.createElement(I.a,{disabled:null===v||void 0===v?void 0:v.loading,title:"Add Address",htmlType:"button",type:"primary",onClick:function(){n((function(e){return[].concat(Object(u.a)(e),[Object(o.a)(Object(o.a)({},v.data),{},{id:(new Date).getTime()})])}))},style:{marginRight:".5em"}},p.a.createElement(N.a,{icon:"plus"}))))},w=["id","states"],U=["id","states"];t.default=function(){Object(_.c)("customer");var e=Object(v.useHistory)(),t=Object(f.useState)(!0),a=Object(m.a)(t,2),S=a[0],I=a[1],T=Object(f.useState)(!1),D=Object(m.a)(T,2),x=D[0],N=D[1],k=Object(O.d)((function(e){return e.auth.token})),L=Object(f.useState)(!1),P=Object(m.a)(L,2),q=P[0],z=P[1],B=Object(f.useState)(null),$=Object(m.a)(B,2),G=$[0],M=$[1],F=c.a.useForm(),V=Object(m.a)(F,1)[0],H=Object(f.useState)(!1),J=Object(m.a)(H,2),Y=J[0],Z=J[1],K={id:(new Date).getTime(),address1:"",address2:"",city:"",country:"",isDefault:!1,state:"",status:!0,zip_code:""},Q=Object(f.useState)([]),W=Object(m.a)(Q,2),X=W[0],ee=W[1],te=Object(f.useState)([]),ae=Object(m.a)(te,2),ne=ae[0],re=ae[1],de=Object(f.useState)(null),se=Object(m.a)(de,2),ie=se[0],ue=se[1],le=Object(f.useState)(null),oe=Object(m.a)(le,2),ce=oe[0],me=oe[1];return Object(f.useEffect)((function(){if(q&&G){var t=ne.map((function(e){e.id,e.states;var t=Object(l.a)(e,w);return Object(o.a)({parent_id:G},t)})),a=X.map((function(e){e.id,e.states;var t=Object(l.a)(e,U);return Object(o.a)(Object(o.a)({},t),{},{parent_id:G})}));["billing","shipping"].forEach((function(n){N(!0),j.j.mutate({mutation:"billing"===n?C.a.ADD_CUSTOMER_BILLING_ADDRESS:C.a.ADD_CUSTOMER_SHIPPING_ADDRESS,variables:{data:{addresses:Object(u.a)("billing"===n?t:a)}},context:{headers:{TENANTID:"100001",Authorization:k}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.updateVendorAddress;null===a||void 0===a||a.status})).catch((function(e){Z(!0)})).finally((function(t){N(!1),"shipping"===n&&(Y||(A.b.success("User Created Successfully."),setTimeout((function(){e.push("/admin/customers/list")}),[2e3])))}))}))}}),[q,G]),p.a.createElement(p.a.Fragment,null,p.a.createElement(b.a,{title:"Add Customer"}),p.a.createElement(g.b,null,p.a.createElement(n.a,{gutter:25},p.a.createElement(r.a,{sm:24,xs:24},p.a.createElement(y.a,{headless:!0},p.a.createElement(c.a,{style:{width:"100%"},form:V,name:"addProduct",onFinish:function(e){var t=ne.find((function(e){var t=e.id,a=e.address1,n=e.country,r=e.city,d=e.state,s=e.zip_code;return!(t&&a&&n&&r&&d&&s)}));if(null===t||void 0===t?void 0:t.id)return A.b.warning("Enter Billing Address Correctly!");var a=X.find((function(e){var t=e.id,a=e.address1,n=e.country,r=e.city,d=e.state,s=e.zip_code;return!(t&&a&&n&&r&&d&&s)}));if(null===a||void 0===a?void 0:a.id)return A.b.warning("Enter Shipping Address Correctly!");N(!0);var n={data:Object(o.a)(Object(o.a)({},e),{},{status:S,send_mail:!0})};j.j.mutate({mutation:C.a.ADD_CUSTOMER,variables:n,context:{headers:{TENANTID:"100001",Authorization:k}},refetchQueries:[{query:C.b.GET_ALL_CUSTOMER,context:{headers:{TENANTID:"100001",Authorization:k}},fetchPolicy:"network-only"},["getAllCustomer"]]}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.addCustomer;if(!a.status)return A.b.error(a.message);z(!0),M(null===a||void 0===a?void 0:a.id)})).catch((function(e){console.log("error on adding customer",e),A.b.error("Something went wrong!!"),Z(!0)})).finally((function(){return N(!1)}))},onFinishFailed:function(e){return console.log("form error info:\n",e)},labelCol:{span:4}},p.a.createElement(d.a,null,p.a.createElement(d.a.TabPane,{tab:"Information",key:"general"},p.a.createElement(c.a.Item,{rules:[{required:!0,max:30,message:"Please enter First Name"}],name:"first_name",label:"First Name"},p.a.createElement(i.a,{placeholder:"Enter First Name"})),p.a.createElement(c.a.Item,{rules:[{required:!0,message:"Please enter Last Name"}],name:"last_name",label:"Last Name"},p.a.createElement(i.a,{placeholder:"Enter Last Name"})),p.a.createElement(c.a.Item,{rules:[{required:!0,message:"Please enter an email",max:30}],name:"email",label:"Email"},p.a.createElement(i.a,{type:"email",placeholder:"Enter Email Address"})),p.a.createElement(c.a.Item,{label:"User Status"},p.a.createElement(s.a,{checked:S,onChange:function(e){return I(e)}}))),p.a.createElement(d.a.TabPane,{tab:"Shipping Address",key:"sAddress"},p.a.createElement(R,{initialData:K,addresses:X,setAddresses:ee,defaultAddressId:ie,setDefaultAddressId:ue})),p.a.createElement(d.a.TabPane,{tab:"Billing Address",key:"bAddress"},p.a.createElement(R,{initialData:K,addresses:ne,setAddresses:re,defaultAddressId:ce,setDefaultAddressId:me}))),p.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"3em"}},p.a.createElement(c.a.Item,null,p.a.createElement(E.a,{loading:x,size:"default",htmlType:"submit",type:"primary",raised:!0},x?"Processing":"Save"),p.a.createElement(h.b,{to:"/admin/customers/list"},p.a.createElement(E.a,{style:{marginLeft:10},type:"light",size:"default"},"Cancel"))))))))))}},616:function(e,t,a){"use strict";a.d(t,"b",(function(){return m})),a.d(t,"a",(function(){return f}));var n,r,d,s,i,u,l,o=a(8),c=a(17),m={GET_ALL_CUSTOMER:Object(c.d)(n||(n=Object(o.a)(["\n    query {\n      getAllCustomer {\n        status\n        message\n        data {\n          id\n          first_name\n          last_name\n          email\n          email_verified\n          user_status\n          image\n          addresses {\n            id\n            address1\n            address2\n            phone\n            fax\n            email\n            city\n            state\n            zip_code\n            country\n            type\n            status\n            updatedAt\n            createdAt\n          }\n        }\n      }\n    }\n  "]))),GET_RATING_BY_USER_ID:Object(c.d)(r||(r=Object(o.a)(["\n    query getRatingsByUserID($query: GetRatingsByUserInput) {\n      getRatingsByUserID(query: $query) {\n        message\n        status\n        data {\n          id\n          rating_description\n          rating\n          createdAt\n          updatedAt\n          product {\n            id\n            prod_name\n            prod_slug\n            prod_short_desc\n            prod_thumbnail\n            prod_sku\n            prod_regular_price\n            prod_sale_price\n            prod_status\n          }\n        }\n      }\n    }\n  "])))},f={ADD_CUSTOMER:Object(c.d)(d||(d=Object(o.a)(["\n    mutation addCustomer($data: CustomerInput) {\n      addCustomer(data: $data) {\n        message\n        status\n        id\n      }\n    }\n  "]))),ADD_CUSTOMER_BILLING_ADDRESS:Object(c.d)(s||(s=Object(o.a)(["\n    mutation addCustomerBillingAddress($data: AddCustomerBillingAddressInput) {\n      addCustomerBillingAddress(data: $data) {\n        message\n        status\n      }\n    }\n  "]))),ADD_CUSTOMER_SHIPPING_ADDRESS:Object(c.d)(i||(i=Object(o.a)(["\n    mutation addCustomerShippingAddress($data: AddCustomerShippingAddressInput) {\n      addCustomerShippingAddress(data: $data) {\n        message\n        status\n      }\n    }\n  "]))),UPDATE_CUSTOMER:Object(c.d)(u||(u=Object(o.a)(["\n    mutation updateCustomer($data: UpdateCustomerInput) {\n      updateCustomer(data: $data) {\n        message\n        status\n      }\n    }\n  "]))),UPDATE_CUSTOMER_ADDRESSES:Object(c.d)(l||(l=Object(o.a)(["\n    mutation updateCustomerAddress($data: UpdateCustomerAddressInput) {\n      updateCustomerAddress(data: $data) {\n        message\n        status\n        tenant_id\n      }\n    }\n  "])))}}}]);