(this.webpackJsonpprimeServerParts=this.webpackJsonpprimeServerParts||[]).push([[49],{938:function(e,t,a){"use strict";a.r(t);a(102);var n,r=a(54),i=(a(100),a(50)),o=(a(101),a(40)),l=(a(144),a(33)),c=(a(74),a(17)),u=(a(121),a(69)),d=(a(200),a(127)),s=a(9),m=a(7),p=a(14),f=(a(624),a(627)),b=a(0),g=a.n(b),_=a(18),v=a.n(_),h=a(81),E=a(77),O=a(76),j=a(72),y=a(193),A=a(11),S=a(25),I=a(29),C=a(103),P=a.n(C),L=a(65),T=a.n(L),x=a(110),k=a(104),w=a(145),D=a(20),N=a(26),z=f.a.RangePicker;t.default=function(){Object(S.c)("product");var e=Object(b.useState)({data:[],isLoading:!0}),t=Object(p.a)(e,2),a=t[0],f=t[1],_=Object(b.useState)([]),C=Object(p.a)(_,2),L=C[0],U=C[1],q=Object(b.useState)(""),F=Object(p.a)(q,2),R=F[0],G=F[1],B=Object(b.useState)(!0),W=Object(p.a)(B,2),J=W[0],K=W[1],M=Object(b.useState)({data:[],isLoading:!0}),H=Object(p.a)(M,2),V=H[0],Y=H[1],Q=Object(b.useState)({data:[],isLoading:!0}),X=Object(p.a)(Q,2),Z=X[0],$=X[1],ee=Object(b.useState)({data:[],isLoading:!0}),te=Object(p.a)(ee,2),ae=te[0],ne=te[1],re=Object(b.useState)({data:[],isLoading:!0}),ie=Object(p.a)(re,2),oe=ie[0],le=ie[1],ce=Object(b.useState)({availability:[],categories:[],condition:[],attributes:[],startDate:"",endDate:"",minPrice:"",maxPrice:""}),ue=Object(p.a)(ce,2),de=ue[0],se=ue[1];Object(b.useEffect)((function(){I.j.query({query:I.l.GET_PRODUCT_LIST,context:{headers:{TENANTID:"100001",Authorization:T.a.get("psp_t")}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getProductList;(null===a||void 0===a?void 0:a.status)&&f((function(e){return Object(m.a)(Object(m.a)({},e),{},{data:null===a||void 0===a?void 0:a.data,error:""})}))})).catch((function(e){f((function(e){return Object(m.a)(Object(m.a)({},e),{},{error:"Something went Wrong.!! "})}))})).finally((function(){f((function(e){return Object(m.a)(Object(m.a)({},e),{},{isLoading:!1})}))})),I.j.query({query:I.l.GET_ALL_CATEGORIES,context:{headers:{TENANTID:"100001"}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getAllCategories;if(a.status&&a.categories.length){var n=[];a.categories.forEach((function(e){var t=e.cat_name;n.push({cat_name:t,id:e.id}),e.subcategories&&e.subcategories.forEach((function(e){var a=e.cat_name;n.push({cat_name:"".concat(t," > ").concat(a),id:e.id}),e.subsubcategories&&e.subsubcategories.forEach((function(e){var r=e.cat_name;n.push({cat_name:"".concat(t," > ").concat(a," > ").concat(r),id:e.id})}))}))})),Y({data:n,isLoading:!1})}})).catch((function(e){})),I.j.query({query:Object(D.d)(n||(n=Object(s.a)(["\n          query getAllAttributes {\n            getAllAttributes {\n              message\n              status\n              tenant_id\n              data {\n                id\n                attribute_name\n              }\n            }\n          }\n        "]))),context:{headers:{TENANTID:"100001",Authorization:T.a.get("psp_t")}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getAllAttributes;a.status&&$({data:a.data,isLoading:!1})})),I.j.query({query:I.n.GET_ALL_AVAILABILITY,context:{headers:{TENANTID:"100001",Authorization:T.a.get("psp_t")}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getAllProductAvailabilityStatus;a.status&&ne({data:a.data,isLoading:!1})})),I.j.query({query:I.n.GET_ALL_CONDITIONS,context:{headers:{TENANTID:"100001",Authorization:T.a.get("psp_t")}}}).then((function(e){var t,a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getAllProductCondition;a.status&&le({data:a.data,isLoading:!1})}))}),[]);var me=[{title:"ID",dataIndex:"id",key:"id",width:70,ellipsis:!0,sorter:function(e,t){return e.id.toUpperCase()>t.id.toUpperCase()?1:-1}},{title:"Logo",dataIndex:"id",key:"id",width:70,render:function(e,t){return g.a.createElement(w.LazyLoadImage,{effect:"blur",width:"40",src:Object(k.renderImage)(t.id,t.prod_thumbnail,"product/image/thumbnail","128x128"),onError:k.errorImageSrc,alt:t.id})}},{title:"Product Name",dataIndex:"prod_name",key:"prod_name",ellipsis:!0,sorter:function(e,t){return e.prod_name.toUpperCase()>t.prod_name.toUpperCase()?1:-1}},{title:"Product SKU",dataIndex:"prod_sku",key:"prod_sku",ellipsis:!0,sorter:function(e,t){return e.prod_sku.toUpperCase()>t.prod_sku.toUpperCase()?1:-1}},{title:"Part NO",dataIndex:"prod_partnum",key:"prod_partnum",ellipsis:!0,sorter:function(e,t){return e.prod_partnum.toUpperCase()>t.prod_partnum.toUpperCase()?1:-1}},{title:"Regular Price",dataIndex:"prod_regular_price",key:"prod_regular_price",ellipsis:!0,align:"center",sorter:function(e,t){return e.prod_regular_price>t.prod_regular_price?1:-1}},{title:"Sales Price",dataIndex:"prod_sale_price",key:"prod_sale_price",ellipsis:!0,align:"center",sorter:function(e,t){return e.prod_sale_price>t.prod_sale_price?1:-1}},{title:"Status",dataIndex:"prod_status",key:"prod_status",align:"right",sorter:function(e,t){return e.prod_status===t.prod_status?0:e.prod_status?-1:1},filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:function(e,t){return t.prod_status===e},render:function(e,t){return g.a.createElement(d.a,{defaultChecked:e,title:"Status",onChange:function(e){return function(e,t){I.j.mutate({mutation:I.k.UPDATE_PRODUCT,variables:{data:{prod_id:e.id,prod_status:t}},context:{headers:{TENANTID:"100001",Authorization:T.a.get("psp_t")}}}).then((function(t){var a,n=null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.updateProduct;if(!n.status)return N.b.error(n.message);N.b.success("".concat(e.prod_sku," status updated."))})).catch((function(e){return N.b.error("Something Went wrong !!")}))}(t,e)}})}},{title:"Is Serial",dataIndex:"is_serial",key:"is_serial",align:"right",sorter:function(e,t){return e.is_serial===t.is_serial?0:e.is_serial?-1:1},filters:[{text:"Active",value:!0},{text:"Inactive",value:!1}],onFilter:function(e,t){return t.is_serial===e},render:function(e,t){return g.a.createElement(d.a,{defaultChecked:e,title:"Is Serial",onChange:function(e){return function(e,t){I.j.mutate({mutation:I.k.PRODUCT_IS_SERIAL_STATUS_CHANGE,variables:{data:{id:e.id,is_serial:t}},context:{headers:{TENANTID:"100001",Authorization:T.a.get("psp_t")}}}).then((function(t){var a,n=null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.changeProductIsSerial;if(!n.status)return N.b.error(n.message);N.b.success("".concat(e.prod_sku," serial status updated."))})).catch((function(e){return N.b.error("Something Went wrong !!")}))}(t,e)}})}},{title:"Action",dataIndex:"action",width:140,align:"center",render:function(e,t){return g.a.createElement(g.a.Fragment,null,g.a.createElement(A.b,{to:"/admin/products/view?id=".concat(t.id)},g.a.createElement(P.a,{name:"eye",style:{margin:".5em 1em"}})),g.a.createElement(A.b,{to:"/admin/products/add?id=".concat(t.id)},g.a.createElement(P.a,{name:"edit",style:{margin:".5em 1em"}})))},key:"last_name"}];return Object(b.useEffect)((function(){if(!a.isLoading){var e=a.data;if(R&&(e=a.data.filter((function(e){return((null===e||void 0===e?void 0:e.prod_name)+(null===e||void 0===e?void 0:e.prod_sku)).toLowerCase().includes(R.toLowerCase())}))),de.startDate){var t=new Date(de.startDate).valueOf(),n=new Date(de.endDate).valueOf();e=e.filter((function(e){var a=parseInt(e.createdAt);return a>=t&&a<=n}))}de.attributes.length&&(e=e.filter((function(e){return de.attributes.find((function(t){return e.prod_attributes.map((function(e){return e.attribute_data.id})).includes(t)}))}))),de.categories.length&&(e=e.filter((function(e){return de.categories.includes(e.category.id)}))),de.availability.length&&(e=e.filter((function(e){return de.availability.includes(e.prod_outofstock_status)}))),de.condition.length&&(e=e.filter((function(e){return de.condition.includes(e.prod_condition)}))),de.minPrice&&(e=e.filter((function(e){return e.prod_regular_price>=parseFloat(de.minPrice)}))),de.maxPrice&&(e=e.filter((function(e){return e.prod_regular_price<=parseFloat(de.maxPrice)}))),U(e)}}),[a,R,de]),g.a.createElement(g.a.Fragment,null,g.a.createElement(h.a,{title:"Products",buttons:[g.a.createElement("div",{key:"1",className:"page-header-actions"},g.a.createElement(j.a,{size:"small",type:"white",onClick:function(){return K((function(e){return!e}))}},g.a.createElement(v.a,{icon:"filter"}),"Filter"),g.a.createElement(A.b,{to:"/admin/products/add"},g.a.createElement(j.a,{size:"small",title:"Add Product",type:"primary"},g.a.createElement(v.a,{icon:"file-plus"}))))]}),g.a.createElement(E.b,null,g.a.createElement(i.a,{gutter:25},g.a.createElement(o.a,{sm:24,xs:24},g.a.createElement(O.a,{headless:!0},a.isLoading?g.a.createElement("div",{className:"spin"},g.a.createElement(u.a,null)):g.a.createElement(g.a.Fragment,null,g.a.createElement(c.a,{placeholder:"Search Products...",prefix:g.a.createElement(y.a,null),onChange:function(e){var t=e.target.value;G(t)}}),g.a.createElement("br",null),g.a.createElement("br",null),J&&g.a.createElement("div",{style:{marginBottom:"2.5em"}},g.a.createElement(i.a,{gutter:16},g.a.createElement(o.a,{span:8},"Availability: ",g.a.createElement("br",null),g.a.createElement(l.a,{style:{width:"100%"},placeholder:"Select status",size:"middle",mode:"multiple",onChange:function(e){se((function(t){return Object(m.a)(Object(m.a)({},t),{},{availability:e})}))},options:ae.data.map((function(e){return{label:e.name,value:e.name}}))})),g.a.createElement(o.a,{span:8},"Category: ",g.a.createElement("br",null),g.a.createElement(l.a,{style:{width:"100%"},placeholder:V.isLoading?"Loading..":"Select category",size:"middle",mode:"multiple",optionFilterProp:"label",onChange:function(e){se((function(t){return Object(m.a)(Object(m.a)({},t),{},{categories:e})}))},options:V.data.map((function(e){return{label:e.cat_name,value:e.id}}))})),g.a.createElement(o.a,{span:8},"Date: ",g.a.createElement("br",null),g.a.createElement(z,{style:{height:"40px",width:"100%"},size:"small",onChange:function(e){se((function(t){return Object(m.a)(Object(m.a)({},t),{},{startDate:e[0]._d,endDate:e[1]._d})}))}}))),g.a.createElement(i.a,{gutter:16,style:{marginTop:".5em"}},g.a.createElement(o.a,{span:8},"Condition: ",g.a.createElement("br",null),g.a.createElement(l.a,{style:{width:"100%"},placeholder:"Select Condition",size:"middle",mode:"multiple",onChange:function(e){return se((function(t){return Object(m.a)(Object(m.a)({},t),{},{condition:e})}))},options:oe.data.map((function(e){return{label:e.name,value:e.name}}))})),g.a.createElement(o.a,{span:8},"Attributes: ",g.a.createElement("br",null),g.a.createElement(l.a,{style:{width:"100%"},placeholder:Z.isLoading?"Loading..":"Select Attribute",size:"middle",mode:"multiple",onChange:function(e){return se((function(t){return Object(m.a)(Object(m.a)({},t),{},{attributes:e})}))},options:Z.data.map((function(e){return{label:e.attribute_name,value:e.id}}))})),g.a.createElement(o.a,{span:8},"Price: ",g.a.createElement("br",null),g.a.createElement(c.a.Group,{compact:!0,size:"default"},g.a.createElement(c.a,{type:"number",placeholder:"Min",style:{width:"50%"},onBlur:function(e){se((function(t){var a;return Object(m.a)(Object(m.a)({},t),{},{minPrice:null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.value})}))}}),g.a.createElement(c.a,{type:"number",placeholder:"Max",style:{width:"50%"},onBlur:function(e){se((function(t){var a;return Object(m.a)(Object(m.a)({},t),{},{maxPrice:null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.value})}))}}))))),g.a.createElement("span",{className:"psp_list"},g.a.createElement(r.a,{className:"table-responsive",columns:me,rowKey:"id",size:"small",dataSource:L,rowClassName:function(e,t){return t%2==0?"":"altTableClass"},pagination:{defaultPageSize:x.a.PRODUCTS_PER_PAGE,total:L.length,showTotal:function(e,t){return"".concat(t[0],"-").concat(t[1]," of ").concat(e," items")}}}))))))))}}}]);