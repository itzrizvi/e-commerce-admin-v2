(this.webpackJsonpprime_server_parts=this.webpackJsonpprime_server_parts||[]).push([[62],{947:function(e,a,t){"use strict";t.r(a);t(200);var r=t(97),n=(t(201),t(74)),l=(t(319),t(80)),c=(t(320),t(228)),i=(t(314),t(218)),o=(t(290),t(117)),s=(t(291),t(89)),u=(t(166),t(98)),d=(t(288),t(69)),m=(t(289),t(52)),g=t(23),E=(t(378),t(220)),y=(t(202),t(63)),p=(t(148),t(45)),_=t(0),f=t.n(_),b=t(21),v=t.n(b),T=t(217),h=t(165),O=t(164),j=t(58),I=t(12),A=t(287),C=t(71),D=t(55),N=t(317),S=t.n(N),M=t(68),w=t.n(M),x=t(22),P=t(76),L=t(136),k=p.a.TextArea,q=y.a.Option,G=E.a.Dragger;a.default=function(){Object(x.f)("category");var e=m.a.useForm(),a=Object(g.a)(e,1)[0],t=Object(_.useState)(!0),E=Object(g.a)(t,2),b=E[0],N=E[1],M=Object(_.useState)(!1),F=Object(g.a)(M,2),R=F[0],V=F[1],z=Object(_.useState)(!1),K=Object(g.a)(z,2),U=K[0],Y=K[1],B=Object(j.useLocation)().search,J=S.a.parse(B),Q=Object(j.useHistory)(),H=Object(_.useState)([]),X=Object(g.a)(H,2),W=X[0],Z=X[1],$=Object(_.useState)({data:[],loading:!0}),ee=Object(g.a)($,2),ae=ee[0],te=ee[1],re=Object(_.useState)({}),ne=Object(g.a)(re,2),le=ne[0],ce=ne[1],ie=Object(_.useState)(""),oe=Object(g.a)(ie,2),se=oe[0],ue=oe[1],de=Object(_.useState)(null),me=Object(g.a)(de,2),ge=me[0],Ee=me[1],ye=Object(_.useState)(""),pe=Object(g.a)(ye,2),_e=pe[0],fe=pe[1];Object(_.useEffect)((function(){C.j.query({query:C.l.GET_ALL_CATEGORIES,context:{headers:{TENANTID:"100001"}}}).then((function(e){var a,t=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.getAllCategories;if(!(null===t||void 0===t?void 0:t.status))return Object(P.a)();Z(t.categories)}))}),[]),Object(_.useEffect)((function(){if(W.length){var e=[];W.forEach((function(a){var t=a.cat_name,r=a.cat_sort_order;e.push({cat_name:t,id:a.id,cat_sort_order:r}),a.subcategories&&a.subcategories.forEach((function(a){var r=a.cat_name;e.push({cat_name:"".concat(t," > ").concat(r),id:a.id})}))})),te({data:e,loading:!1})}}),[W]),Object(_.useEffect)((function(){J.id&&C.j.query({query:C.l.GET_SINGLE_CATEGORY_FOR_UPDATE,variables:{query:{cat_id:parseInt(J.id)}},context:{headers:{TENANTID:"100001"}}}).then((function(e){var a,t=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.getSingleCategory;if(!(null===t||void 0===t?void 0:t.status))return Object(P.a)();ce(t.category),V((function(e){var a;return(null===t||void 0===t||null===(a=t.category)||void 0===a?void 0:a.is_featured)||e})),N((function(e){var a;return(null===t||void 0===t||null===(a=t.category)||void 0===a?void 0:a.cat_status)||e})),ue((function(e){var a;return(null===t||void 0===t||null===(a=t.category)||void 0===a?void 0:a.cat_parent_id)||e}))}))}),[]);return f.a.createElement(f.a.Fragment,null,f.a.createElement(T.a,{title:J.id?"Manage category | Edit - ".concat(le.cat_name?"(".concat(le.cat_name,")"):"","\t"):"Add Category"}),f.a.createElement(h.b,null,f.a.createElement(r.a,{gutter:25},f.a.createElement(n.a,{sm:24,xs:24},f.a.createElement(O.a,{headless:!0},J.id&&!le.id?f.a.createElement("div",{className:"spin"},f.a.createElement(u.a,null)):f.a.createElement(m.a,{style:{width:"100%"},form:a,name:"addRole",onFinish:function(e){Y(!0);var a=e.categoryName,t=e.categoryDescription,r=e.categoryMetaTagDescription,n=e.categoryMetaTagKeywords,l=e.categoryMetaTagTitle,c=e.categorySortOrder;if(J.id){var i={cat_id:parseInt(J.id),cat_name:a,cat_description:t,cat_meta_tag_title:l,cat_meta_tag_description:r,cat_meta_tag_keywords:n,is_featured:R,cat_status:b};se&&(i.cat_parent_id=se),ge&&(i.categoryImage=ge.file),c&&(i.cat_sort_order=parseInt(c)),C.a.mutate({mutation:C.k.UPDATE_CATEGORY,variables:{data:i},refetchQueries:[{query:C.l.GET_ALL_CATEGORIES,context:{headers:{TENANTID:"100001"}}},["getAllBrands"]],fetchPolicy:"network-only",context:{headers:{TENANTID:"100001",Authorization:w.a.get("psp_t")}}}).then((function(e){var a,t=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.updateCategory;if(!(null===t||void 0===t?void 0:t.status))return Object(P.a)();setTimeout((function(){Q.push("/admin/categories/list")}),1e3),d.b.success(null===t||void 0===t?void 0:t.message)})).finally((function(){Y(!1)}))}else{var o={categoryName:a,categoryDescription:t,categoryMetaTagDescription:r,categoryMetaTagKeywords:n,categoryMetaTagTitle:l,isFeatured:R,categoryStatus:b};se&&(o.categoryParentId=se),c&&(o.categorySortOrder=parseInt(c));var s={data:o};ge&&(s.file=ge),console.log(s),C.a.mutate({mutation:C.k.CREATE_CATEGORY,variables:s,refetchQueries:[{query:C.l.GET_ALL_CATEGORIES,context:{headers:{TENANTID:"100001"}}},["getAllCategories"]],fetchPolicy:"network-only",context:{headers:{TENANTID:"100001",Authorization:w.a.get("psp_t")}}}).then((function(e){var a,t=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.createCategory;if(!(null===t||void 0===t?void 0:t.status))return Object(P.a)();setTimeout((function(){Q.push("/admin/categories/list")}),1e3),d.b.success(null===t||void 0===t?void 0:t.message)})).finally((function(){Y(!1)}))}},onFinishFailed:function(e){return console.log("form error info:\n",e)},labelCol:{span:4}},f.a.createElement(s.a,null,f.a.createElement(s.a.TabPane,{tab:"General",key:"general"},f.a.createElement(m.a.Item,{rules:[{required:!0,max:30,message:"Please enter Category Name"}],name:"categoryName",label:"Category Name",initialValue:le.cat_name||""},f.a.createElement(p.a,{placeholder:"Enter Category Name"})),f.a.createElement(m.a.Item,{rules:[{required:!0,max:30,message:"Please enter Category Description"}],name:"categoryDescription",label:"Description",initialValue:le.cat_description||""},f.a.createElement(k,{rows:4,placeholder:"Enter Category Description"})),f.a.createElement(m.a.Item,{rules:[{required:!0,max:30,message:"Please enter Meta Title"}],name:"categoryMetaTagTitle",label:"Meta Tag Title",initialValue:le.cat_meta_tag_title||""},f.a.createElement(p.a,{placeholder:"Enter Meta Tag Title"})),f.a.createElement(m.a.Item,{name:"categoryMetaTagDescription",label:"Meta Tag Description",rules:[{required:!0,max:30,message:"Please enter Meta Description"}],initialValue:le.cat_meta_tag_description||""},f.a.createElement(k,{rows:3,placeholder:"Enter Meta Tag Description"})),f.a.createElement(m.a.Item,{className:"wrap-label",rules:[{required:!0,max:30,message:"Please enter Meta Keywords"}],name:"categoryMetaTagKeywords",label:"Enter Meta Tag Keywords",initialValue:le.cat_meta_tag_keywords||""},f.a.createElement(k,{rows:3,placeholder:"Enter Meta Tag Keywords"}))),f.a.createElement(s.a.TabPane,{tab:"Data",key:"Data"},f.a.createElement(m.a.Item,{name:"categoryParentId",initialValue:"",label:"Parent"},ae.loading?f.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},f.a.createElement(u.a,null)):f.a.createElement(f.a.Fragment,null,f.a.createElement(y.a,{allowClear:!0,placeholder:"Please select",onChange:function(e){return ue(e)},defaultValue:le.cat_parent_id},ae.data.map((function(e){return f.a.createElement(q,{key:e.id,value:e.id},e.cat_name)}))))),f.a.createElement(m.a.Item,{name:"categorySortOrder",label:"Sort Order",initialValue:le.cat_sort_order||""},f.a.createElement(p.a,{placeholder:"Enter Sort Order"})),f.a.createElement(m.a.Item,{name:"isFeatured",label:"Is Featured"},f.a.createElement(o.a,{checked:R,onChange:function(e){return V(e.target.checked)}})),f.a.createElement(m.a.Item,{name:"categoryStatus",label:"Status"},f.a.createElement(i.a,{checked:b,onChange:function(e){return N(e)}})),f.a.createElement(m.a.Item,{name:"img",label:"Image"},_e?f.a.createElement(l.a,{text:"x"},f.a.createElement(c.a,{shape:"square",size:80,src:_e,onClick:function(){Ee(null),fe("")}})):f.a.createElement(G,{multiple:!1,beforeUpload:function(e){return"image/jpeg"===e.type?e.size/1024/1024<2?(fe(URL.createObjectURL(e)),Ee(e),!1):d.b.error(L.a.FILE_MAX_2MB):d.b.error(L.a.ONLY_JPG_FILE_UPLOAD)},onRemove:function(e){fe(""),Ee(null)},fileList:ge?[ge]:[],style:{marginTop:"3em"}},f.a.createElement("p",{className:"ant-upload-drag-icon"},f.a.createElement(v.a,{icon:"upload",size:50})),f.a.createElement(D.a,{as:"h4",className:"ant-upload-text"},"Drag and drop an image"),f.a.createElement("p",{className:"ant-upload-hint"},"or ",f.a.createElement("span",null,"Browse")," to choose a file"))))),";",f.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"3em"}},f.a.createElement(m.a.Item,null,f.a.createElement(A.a,{loading:U,size:"default",htmlType:"submit",type:"primary",raised:!0},U?"Processing":"Save"),f.a.createElement(I.b,{to:"/admin/categories/list"},f.a.createElement(A.a,{style:{marginLeft:10},type:"light",size:"default"},"Cancel"))))))))))}}}]);