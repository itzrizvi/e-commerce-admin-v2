(this.webpackJsonpprimeServerParts=this.webpackJsonpprimeServerParts||[]).push([[21],{627:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a,r,i,l,d,o,u,c=n(11),s=n(20),m={BANNER_ADD:Object(s.d)(a||(a=Object(c.a)(["\n    mutation addBanner($data: BannerInput) {\n        addBanner(data: $data) {\n        message\n        status\n        data {\n            id\n        }\n      }\n    }"]))),BANNER_IMAGE_ADD:Object(s.d)(r||(r=Object(c.a)(["\n    mutation addBannerImage($data: BannerImageInput!) {\n      addBannerImage(data: $data) {\n        message\n        status\n        data {\n          id\n          title\n          link\n          sort_order\n        }\n      }\n    }"]))),GET_ALL_BANNER:Object(s.d)(i||(i=Object(c.a)(["\n    query getAllBanners{\n      getAllBanners {\n        message\n        status\n        tenant_id\n        data {\n          id\n          name\n          slug\n          status\n          createdAt\n        }\n      }\n    }"]))),GET_SINGLE_BANNER:Object(s.d)(l||(l=Object(c.a)(["\n    query getSingleBanner($banner_id : Int!){\n    getSingleBanner(query: {banner_id: $banner_id}) {\n      message\n      tenant_id\n      status\n      data {\n        id\n        name\n        status\n        banner_images {\n          id \n          image\n          link\n          sort_order\n          title\n        }\n      }\n    }\n  }"]))),BANNER_UPDATE:Object(s.d)(d||(d=Object(c.a)(["\n  mutation updateBanner($data: UpdateBannerInput){\n    updateBanner(data:$data){\n      message\n      status\n    }\n  }"]))),BANNER_IMAGE_UPDATE:Object(s.d)(o||(o=Object(c.a)(["\n    mutation updateBannerImage($data: UpdateBannerImageInput){\n    updateBannerImage(data: $data) {\n      message\n      status\n    }\n  }"]))),BANNER_IMAGE_DELETE:Object(s.d)(u||(u=Object(c.a)(["\n    mutation deleteBannerImage($banner_uuid: UUID!) {\n      deleteBannerImage(data: {banner_uuid: $banner_uuid}) {\n        message\n        status\n        tenant_id\n      }\n    }"])))}},891:function(e,t,n){"use strict";n.r(t);n(131);var a=n(67),r=(n(132),n(44)),i=(n(282),n(133)),l=(n(257),n(147)),d=n(179),o=(n(609),n(608)),u=(n(143),n(68)),c=n(12),s=(n(281),n(60)),m=n(33),g=n(0),b=n.n(g),f=n(146),E=n(145),p=n(144),h=n(178),B=n(54),A=n(10),_=n(46),v=n(50),y=n(353),I=n(627),O=n(284),j=n(260),N=n(285),k=n(26),T=n.n(k),S=n(34);t.default=function(){Object(S.b)("banner");var e=Object(B.useHistory)(),t=Object(_.d)((function(e){return e.auth.token})),n=Object(g.useState)(!1),k=Object(m.a)(n,2),x=k[0],D=k[1],L=Object(g.useState)(!0),w=Object(m.a)(L,2),C=w[0],R=w[1],$=Object(g.useState)(""),U=Object(m.a)($,2),z=U[0],G=U[1],P=s.a.useForm(),F=Object(m.a)(P,1)[0],q={id:(new Date).getTime(),title:"",link:"",image:"",sort_order:"",action:""},M=Object(g.useState)([q]),J=Object(m.a)(M,2),W=J[0],H=J[1],K=function(e){var t="image/jpeg"===e.type;t||v.b.error("You can only upload JPG file!");var n=e.size/1024/1024<1;return n||v.b.error("Image must smaller than 1MB!"),t&&n&&G(e),!1},Q=b.a.createElement("div",null,b.a.createElement(y.a,null),b.a.createElement("div",{style:{marginTop:8}}," Upload ")),Y=function(e){if(e&&"target"in e&&"getAttribute"in e.target){var t=e.target.getAttribute("data-id");if(t)W.map((function(e){return e.id==t&&(e.image=z),e}))}},V=[{title:"Title",dataIndex:"title",key:"title",render:function(e,t){return b.a.createElement(u.a,{type:"text",placeholder:"Title",onChange:function(e){return t.title=e.target.value}})}},{title:"Link",dataIndex:"link",key:"link",render:function(e,t){return b.a.createElement(u.a,{type:"text",placeholder:"Link",onChange:function(e){return t.link=e.target.value}})}},{title:"Image",dataIndex:"image",key:"image",render:function(e,t){return b.a.createElement(o.a,{name:"avatar",listType:"picture-card","data-id":t.id,className:"avatar-uploader",showUploadList:!1,beforeUpload:K,onChange:Y(event),fileList:[]},t.image?b.a.createElement(N.LazyLoadImage,{src:URL.createObjectURL(t.image),onError:j.errorImageSrc,alt:"image",style:{width:"100%"}}):Q)}},{title:"Sort Order",dataIndex:"sort_order",key:"sort_order",width:150,render:function(e,t){return b.a.createElement(u.a,{type:"number",placeholder:"Sort Order",onChange:function(e){return t.sort_order=parseInt(e.target.value)}})}},{title:"Action",dataIndex:"action",key:"action",render:function(e,t){return b.a.createElement(h.a,{size:"",title:"Remove",type:"danger",onClick:function(){return X(t.id)}},b.a.createElement(T.a,{icon:"minus"}))}}],X=function(e){H((function(t){return t.filter((function(t){return t.id!==e}))}))};return b.a.createElement(b.a.Fragment,null,b.a.createElement(f.a,{title:"Add Banner"}),b.a.createElement(E.b,null,b.a.createElement(a.a,{gutter:25},b.a.createElement(r.a,{sm:24,xs:24},b.a.createElement(p.a,{headless:!0},b.a.createElement(s.a,{style:{width:"100%"},form:F,name:"addBanner",onFinish:function(n){var a=!0;if(W.forEach((function(e){if(a&&(""==e.image||""==e.title))return v.b.info("Please Provide All Banner Image First!"),void(a=!1)})),a){D(!0);var r=Object(c.a)(Object(c.a)({},n),{},{banner_status:C});O.b.mutate({mutation:I.a.BANNER_ADD,variables:{data:r},context:{headers:{TENANTID:"100001",Authorization:t}},refetchQueries:[{query:I.a.GET_ALL_BANNER,context:{headers:{TENANTID:"100001",Authorization:t}}},"getAllBanners"]}).then((function(e){var n,a,r=null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.addBanner;if(!(null===r||void 0===r?void 0:r.status))return v.b.error("Something Went wrong !");var i=null===r||void 0===r||null===(a=r.data)||void 0===a?void 0:a.id;W.forEach((function(e,n){O.a.mutate({mutation:I.a.BANNER_IMAGE_ADD,variables:{data:{banner_id:i,title:e.title,sort_order:e.sort_order,link:e.link,image:e.image}},context:{headers:{TENANTID:"100001",Authorization:t}}}).then((function(e){W.length===n+1&&setTimeout((function(){window.location.reload()}),2e3)})).catch((function(e){v.b.error("Something Went wrong !!")}))}))})).catch((function(e){v.b.error("Something Went wrong !!!")})).finally((function(){D(!1),e.push("/admin/banner/list"),v.b.success("Banner Added Successfully!")}))}},onFinishFailed:function(e){return console.log("form error info:\n",e)},labelCol:{span:4}},b.a.createElement(s.a.Item,{rules:[{required:!0,max:50,message:"Please Enter Banner Name"}],name:"banner_name",label:"Banner Name"},b.a.createElement(u.a,{placeholder:"Enter Banner Name"})),b.a.createElement(s.a.Item,{label:"Status"},b.a.createElement(l.a,{checked:C,onChange:function(e){return R(e)},checkedChildren:"ON",unCheckedChildren:"OFF"})),b.a.createElement(i.a,{className:"table-responsive",columns:V,pagination:!1,rowKey:"id",size:"small",dataSource:W}),b.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"10px",marginBottom:"10px"}},b.a.createElement(h.a,{onClick:function(){var e={id:(new Date).getTime(),title:"",link:"",image:"",sort_order:""};H((function(t){return[].concat(Object(d.a)(t),[e])}))},size:"small",title:"Add Banner",htmlType:"button",type:"primary"},b.a.createElement(T.a,{icon:"plus"}))),b.a.createElement("div",{style:{display:"flex",justifyContent:"flex-start"}},b.a.createElement(s.a.Item,null,b.a.createElement(h.a,{loading:x,size:"default",htmlType:"submit",type:"primary",raised:!0},x?"Processing":"Save"),b.a.createElement(A.b,{to:"/admin/banner/list"},b.a.createElement(h.a,{style:{marginLeft:10},type:"light",size:"default"},"Cancel"))))))))))}}}]);